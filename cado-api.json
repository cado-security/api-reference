{"openapi":"3.1.0","info":{"title":"Cado Platform API","description":"\nThe documentation reference for the Cado platform's RESTful API. \nThe API can integrate with every part of the platform, from user management, querying timeline data, and importing evidence from the cloud.\nWe provide some <a href=\"https:\/\/github.com\/cado-security\/cado-api-examples\">example Python scripts<\/a> to help you get started.\n<br \/><br \/>\nUsing the API requires an API key, which can be <a href=\"https:\/\/docs.cadosecurity.com\/cado-response\/manage\/integrations\/api-overview\">obtained from the Cado platform<\/a>.\nThis API key needs to be used with the `Authorization` header in the Bearer format. For example: <code>Authorization: Bearer YOUR_API_KEY<\/code>.\n<br \/><br \/>\nEach API will have a few extra parameters listed in the description, these parameters describe how the API behaves and what it expects. The parameters we list are:\n<ul>\n    <li><b>Feature Lifecycle<\/b>: This indicates if the API is in <code>beta<\/code> or <code>production<\/code>. If the API is in beta, you may need to enable it in the Experiments settings inside the platform. APIs with a <code>beta<\/code> flag are considered unstable and are subject to change or removal at any point, and are not recommended for production use.<\/li>\n<\/ul>\n","version":"2.221.0","x-logo":{"altText":"Cado Security","url":"static\/logo.png"}},"components":{"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}},"schemas":{"note_schema":{"type":"object","required":["alarms","items","display_name","log"],"properties":{"id":{"description":"Id of the note.","type":"integer"},"evidence_id":{"description":"Id of the evidence associated with the note.","type":"integer"},"event_id":{"description":"The timeline event id of the note.","type":"string"},"user_id":{"description":"The user id of the note creator.","type":"integer"},"created":{"description":"Timestamp of the note creation.","type":"number"},"note":{"$ref":"#\/components\/schemas\/note_data"}}},"note_data":{"oneOf":[{"type":"object","required":["type"],"properties":{"type":{"description":"Type of the note.","type":"string","default":"star","enum":["star"]}}},{"type":"object","required":["type","text"],"properties":{"type":{"description":"Type of the note.","type":"string","default":"comment","enum":["comment"]},"text":{"description":"The text of the comment.","type":"string"}}}]},"settings_schema":{"type":"object","properties":{"worker":{"type":"object","properties":{"local":{"type":"boolean","description":"Enable or disable local worker."},"max":{"type":"integer","description":"Maxium number of worker VMs to deploy."},"instance":{"type":"string","description":"Instance type to use for worker VMs."},"shutdown_wait":{"type":"integer","description":"Time (in seconds) to wait after a worker becomes idle before shutting it down."}}},"minimum_role_deployment":{"type":"boolean","description":"Confirm scoped up instance role."},"bucket":{"type":"string","description":"The primary bucket\/container Cado will use for Host acquisition, health checks, and evidence preservation."},"azure_storage_account":{"type":"string","description":"The storage account in which the container for Host acquisition, health checks, and evidence preservation resides"},"setup_complete":{"type":"boolean","description":"Whether the initial setup has been completed."},"private_gcp_api_endpoint":{"type":"string","description":"Private GCP API Endpoint."},"debug_logs_endpoint_enabled":{"type":"boolean","description":"Enable Log Access for Upgrade Issues."},"telemetry_enabled":{"type":"boolean","description":"Enable Telemetry."},"cado_host":{"oneOf":[{"type":"object","required":["download_location","url"],"properties":{"download_location":{"type":"string","default":"self_hosted","enum":["self_hosted"]},"url":{"type":"string"}}},{"type":"object","required":["download_location"],"properties":{"download_location":{"type":"string","default":"cado","enum":["cado"]}}},{"type":"object","required":["skip_ssl_verify"],"properties":{"skip_ssl_verify":{"type":"boolean"}}}]},"ee":{"oneOf":[{"type":"object","required":["preset","min_recursion","max_recursion","branch_limit"],"properties":{"preset":{"description":"Extraction engine settings preset.","type":"string","default":"custom","enum":["custom"]},"max_recursion":{"description":"Extraction engine maxium recursion depth.","type":"integer"},"min_recursion":{"description":"Extraction engine minimum recursion depth.","type":"integer"},"branch_limit":{"description":"Extraction engine recursion branch limit","type":"integer"}}},{"type":"object","required":["preset"],"properties":{"preset":{"description":"Extraction engine settings preset.","type":"string","enum":["fast","full"]}}}]},"feature_flag":{"properties":{"private_workers":{"type":"boolean"},"automated_response":{"type":"boolean"}}},"proxy":{"required":["url"],"properties":{"url":{"description":"Proxy URL for outbound connections","type":"string"},"cert_url":{"description":"Location of proxy certificate","type":"string"},"whitelist":{"description":"Domains or IP addresses that the proxy should not be used for (one per line)","type":"string"}}},"siem":{"required":["integration","s3_bucket","s3_folder"],"properties":{"integration":{"type":"boolean","description":"Enable or disable SIEM integration."},"s3_bucket":{"type":"string","description":"S3 bucket to output SIEM integration data to"},"s3_folder":{"description":"Folder within S3 bucket to output SIEM integration data to","type":"string"}}},"tag":{"description":"Tag to be applied to resources created by Cado","required":["key","value"],"properties":{"key":{"type":"string"},"value":{"type":"string"}}},"detections":{"description":"Detection settings","properties":{"detection_group_enabled":{"type":"boolean","description":"Enable or disable allowing group access to all investigations created by a Detection Rule"},"detection_group_id":{"type":"integer","description":"The ID of the Group to add to investigations created by a Detection Rule"},"filter":{"oneOf":[{"type":"object","description":"Hostname Detections filter","properties":{"hostname":{"type":"object","description":"Hostname Detections include filter","properties":{"include":{"type":"array","items":{"type":"string"}},"exclude":{"type":"array","items":{"type":"string"}}}}}}]}}}}},"evidence_schema":{"type":"object","required":["id","alarms","items","display_name","log"],"properties":{"alarms":{"type":"object","description":"Summary of alarms detected in this evidence","nullable":false,"required":["malicious","suspicious"],"properties":{"malicious":{"description":"Number of malicious alarms","type":"integer"},"suspicious":{"description":"Number of suspicious alarms","type":"integer"}}},"id":{"type":"integer","description":"The ID of the evidence"},"project_id":{"type":"integer","description":"The ID of the project the evidence belongs to"},"display_name":{"type":"string","description":"The display name of the evidence"},"description":{"type":"string","description":"The description of the evidence"},"log":{"type":"string","description":"When the evidence started processing"},"resource":{"type":"object","description":"Information about the resource the evidence was captured from","properties":{"id":{"type":"string","description":"The ID of the resource"},"type":{"type":"string","description":"The type of the resource"},"account_id":{"type":"string","description":"The ID of the account the resource is from"},"account_type":{"type":"string","description":"The type of the account the resource is from"},"roles":{"type":"array","items":{"type":"string"},"description":"The roles associated with the resource"},"parent_id":{"type":"string","description":"The resource ID of the parent resource"}}},"preservation":{"type":"object","properties":{"encase":{"type":"string","description":"The path to the Encase file"},"raw":{"type":"string","description":"The path to the preservation file"}}},"items":{"type":"integer","description":"The number of evidence items within an evidence"},"processing_ran":{"type":"boolean","description":"Whether the processing pipeline has run"}}},"pagination":{"type":"object","description":"Pagination information","required":["type","total_records","current_page","total_pages"],"properties":{"type":{"type":"string","enum":["page"],"default":"page","description":"A string indicating the type of pagination supported by the API. In this context, the value will be \"page\"."},"total_records":{"type":"integer","description":"An integer representing the total amount of data we're paging."},"current_page":{"type":"integer","description":"An integer representing the current page of data (we use this to work out next and previous pages). NOTE: this is 1-indexed (i.e. it starts at 1)."},"total_pages":{"type":"integer","description":"An integer representing the total number of pages."},"per_page":{"type":"integer","description":"An integer representing the number of records per page."}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}}}},"paths":{"\/api\/v3\/import\/aws\/ec2":{"get":{"summary":"Browse a list of EC2 instances","description":"Browse a list of EC2 instances inside a specific AWS region and account.","parameters":[{"name":"cloud_id","in":"query","required":true,"schema":{"type":"string"},"description":"The alias of the chosen AWS account to browse. See the <a href=\"#\">Clouds API<\/a> documentation for more info on obtaining the cloud_id for a specific AWS account."},{"name":"region","in":"query","required":true,"schema":{"type":"string"},"description":"The AWS region to browse EC2 instances in."},{"name":"instance_id","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}},"description":"The instance ID of the EC2 instances to browse."},{"name":"instance_name","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}},"description":"The name of the instances to browse."},{"name":"state","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}},"description":"The state of the instances pending | running | shutting-down | terminated | stopping | stopped to browse."},{"name":"ip_address","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}},"description":"The Public IP address of the instances to browse."},{"name":"cursor","in":"query","required":false,"schema":{"type":"string"},"description":"The pointer to the next page given by the response of the previous\/current page."},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":10},"description":"The amount of items to be given per page. If left blank, the default will be 10."}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"array","items":{"type":"object","description":"An EC2 instance","required":["instance_name","instance_id","state","instance_type","availability_zone","importable"],"properties":{"instance_name":{"type":"string","description":"The name of the EC2 instance."},"instance_id":{"type":"string","description":"The ID of the EC2 instance."},"state":{"type":"string","description":"The state of the EC2 instance."},"instance_type":{"type":"string","description":"The type of the EC2 instance."},"ip_address":{"type":"string","description":"The Public IP address of the EC2 instance."},"availability_zone":{"type":"string","description":"The availability zone of the EC2 instance."},"importable":{"type":"boolean","description":"A boolean indicating whether the EC2 instance can be imported. You cannot import Cado platform instances or their workers."}}}},"pagination":{"type":"object","properties":{"type":{"type":"string","enum":["cursor"],"default":"cursor","description":"A string indicating the type of pagination supported by the API. In this context, the value will be \"cursor\"."},"current_token":{"type":"string","description":"A string representing the pointer to this current page."},"next_token":{"type":"string","description":"A string representing a cursor to the next page. Use this in place of the `cursor` attribute to get the next page."},"previous_token":{"type":"string","description":"A string representing a cursor to the previous page. Use this in place of the `cursor` attribute to get the previous page."}},"required":["type"]},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["data","status","pagination"],"type":"object"}}},"description":""},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"tags":["Import from AWS"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"},"post":{"summary":"Start an import of an EC2 instance into a specified project","description":"Start an import of an EC2 into the specified project. A processing pipeline will be returned that details the status of the processing.","x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"tags":["Import from AWS"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["instance_id","region","project_id"],"properties":{"instance_id":{"type":"string","description":"Unique string for instance. Can be retrieve from the GET method."},"cloud_id":{"type":"string","description":"The AWS credentials alias to perform the import."},"token":{"type":"string","description":"The AWS STS token that can be used for the import."},"region":{"type":"string","description":"AWS region id."},"project_id":{"type":"integer","description":"The ID of the Cado project that you want to import the data into."},"compress":{"type":"boolean","description":"Compress the disks."},"acquire_with_host":{"type":"boolean","description":"Acquire with Cado Host over SSM instead of the EC2 EBS API."},"use_ssm_port_forwarding":{"type":"boolean","description":"Use SSM port forwarding to send Cado Host to the instance."},"override_instance_type":{"type":"string","description":"Start any and all machines in the acquisition process with this instance type instead of default behavior."},"convert_image":{"type":"boolean","description":"Enable convert image to encase files."},"skip_processing":{"type":"boolean","description":"Acquire the resource without performing any processing, allowing processing to happen at a later time."},"ssm_port_forwarding_port":{"type":"integer","description":"The port to use for SSM port forwarding to allow Cado Host to connect to the instance."}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","default":"error","enum":["error"]},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"A new pipeline object is returned, indicating a successful kick-off of a pipeline. You can see the <a href=\"#\">Pipeline API<\/a> documentation for information on getting details about this pipeline.","content":{"application\/json":{"schema":{"required":["data","status"],"properties":{"status":{"enum":["success"],"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","required":["pipeline_ids"],"properties":{"pipeline_ids":{"type":"array","items":{"type":"object","required":["id"],"properties":{"id":{"type":"integer"}}}}}}}}}}}}}},"\/api\/v3\/import\/url":{"post":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Import evidence from a URL","description":"Import evidence from a given URL via a standard download.","tags":["Import from URL"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["url","project_id"],"properties":{"project_id":{"type":"integer","minimum":1,"description":"The ID of the project to import the evidence into."},"url":{"type":"string","pattern":"^(?!mailto:)(?:(?:http|https|ftp):\/\/)(?:\\\\S+(?::\\\\S*)?@)?(?:(?:(?:[1-9]\\\\d?|1\\\\d\\\\d|2[01]\\\\d|22[0-3])(?:\\\\.(?:1?\\\\d{1,2}|2[0-4]\\\\d|25[0-5])){2}(?:\\\\.(?:[0-9]\\\\d?|1\\\\d\\\\d|2[0-4]\\\\d|25[0-4]))|(?:(?:[a-z\\\\u00a1-\\\\uffff0-9]+-?)*[a-z\\\\u00a1-\\\\uffff0-9]+)(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff0-9]+-?)*[a-z\\\\u00a1-\\\\uffff0-9]+)*(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff]{2,})))|localhost)(?::\\\\d{2,5})?(?:(\/|\\\\?|#)[^\\\\s]*)?$","description":"The URL of the evidence to import."}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","default":"error","enum":["error"]},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"A new pipeline object is returned, indicating a successful kick-off of a pipeline. You can see the <a href=\"https:\/\/cado-security.github.io\/api-reference\/#tag\/Pipelines\/paths\/~1api~1v3~1pipelines~1{id}\/get\">Pipeline API<\/a> documentation for information on getting details about this pipeline.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"enum":["success"],"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","description":"The data returned by the API.","schema":null,"required":["pipeline_id"],"properties":{"pipeline_id":{"type":"integer","description":"The ID of the pipeline that was created to process the evidence."}}}}}}}}}}},"\/api\/v3\/users\/{user_id}\/eula":{"patch":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Update user's EULA details","description":"Update user's EULA details.","tags":["EULA"],"security":[{"bearerAuth":[]}],"externalDocs":{"description":"Find out more about our EULA here:","url":"https:\/\/docs.cadosecurity.com\/eula\/commercial-eula"},"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer"},"description":"ID of the user signing the EULA."}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["eula_agreement","eula_version"],"properties":{"eula_agreement":{"type":"string","description":"Details of which agreement user has signed."},"eula_version":{"type":"string","description":"Version of agreement signed."}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","enum":["error"],"description":"The status of the response, in this context, the value will be \"error\".","default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Details of the user's EULA agreement.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","enum":["success"],"description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","description":"Data of the user and eula.","schema":null,"required":["id","eula_agreement","eula_version","eula_sign_date"],"properties":{"id":{"description":"User ID","type":"integer"},"eula_agreement":{"description":"Details of which agreement user has signed","type":"string"},"eula_version":{"description":"Version of agreement signed","type":"string"},"eula_sign_date":{"description":"Epoch unix timestamp of when the user signed the EULA","type":"number","example":1716398601.220793}}}}}}}}}}},"\/api\/v3\/pipelines":{"get":{"description":"List pipelines visible to the current user.","parameters":[{"name":"page","in":"query","description":"Which page of results to return, ordered by created desc","required":false,"schema":{"type":"integer","default":1}},{"name":"per_page","in":"query","description":"How many results per page, ordered by created desc.","required":false,"schema":{"type":"integer","default":10}},{"name":"project_id","in":"query","description":"Filter by project id","required":false,"schema":{"type":"integer"}},{"name":"evidence_id","in":"query","description":"Filter by evidence id","required":false,"schema":{"type":"integer"}},{"name":"evidence_name","in":"query","description":"Filter by evidence name","required":false,"schema":{"type":"string"}},{"name":"investigation_name","in":"query","description":"Filter by investigation name","required":false,"schema":{"type":"string"}},{"name":"user","in":"query","description":"Filter by triggering user","required":false,"schema":{"type":"string"}},{"name":"type","in":"query","description":"Filter by pipeline type","required":false,"schema":{"type":"string","enum":["processing","acquisition","healthcheck","investigation_kicker","accountdiscovery","analysis","remote_action"]}},{"name":"triggering_pipeline_id","in":"query","description":"Filter by triggering pipeline id","required":false,"schema":{"type":"integer"}},{"name":"order_by","in":"query","description":"Order by field, default created desc.","schema":{"type":"string","enum":["project_name","-project_name","evidence_name","-evidence_name","created","-created","user_name","-user_name"]}},{"name":"pipeline_status","in":"query","description":"Filter by the pipeline status","schema":{"type":"string","enum":["success","failed","cancelled","pending"]}}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"array","items":{"type":"object","required":["aborted","can_be_terminated","created","kick_off","name","pipeline","subtasks","summary","terminated"],"properties":{"aborted":{"type":"boolean","description":"Has the pipeline been aborted?"},"can_be_terminated":{"type":"boolean","description":"Can the pipeline be terminated?"},"created":{"type":"number","description":"Creation timestamp (ms since epoch)"},"evidence":{"type":"object","nullable":true,"required":["id","name"],"description":"Details of the evidence the pipeline relates to","properties":{"id":{"type":"integer","description":"Evidence ID the pipeline relates to"},"name":{"type":"string","description":"Evidence name the pipeline relates to"}}},"kick_off":{"type":"array","description":"Details of the alert that kicked off the pipeline","items":{"type":"string"}},"name":{"type":"string","description":"Pipeline name"},"pipeline":{"type":"object","required":["id","type"],"description":"Details of the pipeline","properties":{"id":{"type":"integer","description":"Pipeline ID"},"type":{"type":"string","description":"Type of pipeline","enum":["processing","acquisition","healthcheck","inventory","investigation_kicker","accountdiscovery","analysis","remote_action"]}}},"project":{"type":"object","required":["id","name"],"description":"Details of the project the pipeline relates to","properties":{"id":{"type":"integer","description":"Project ID the pipeline relates to"},"name":{"type":"string","description":"Project name the pipeline relates to"}}},"subtasks":{"type":"array","description":"Details of the subtasks for the pipeline","items":{"type":"object","required":["execution_duration","finish_time","name","name_key","notification_level","progress_text","start_time","state"],"properties":{"execution_duration":{"type":"integer","description":"Execution duration in seconds"},"finish_time":{"type":"number","description":"Finish time (ms since epoch)"},"name":{"type":"string","description":"Subtask name"},"name_key":{"type":"string","description":"Subtask name key"},"notification_level":{"type":"string","description":"Notification level"},"progress_text":{"type":"array","items":{"type":"string"},"description":"Progress text"},"start_time":{"type":"number","description":"Start time (ms since epoch)"},"state":{"type":"string","description":"State of the subtask","enum":["PENDING","RUNNING","SUCCESS","FAILURE","CANCELLED"]},"total_stages":{"type":"integer","nullable":true,"description":"Total stages"}}}},"summary":{"type":"object","required":["total","success","failure","pending","cancelled","running"],"properties":{"total":{"type":"integer"},"success":{"type":"integer"},"failure":{"type":"integer"},"pending":{"type":"integer"},"cancelled":{"type":"integer"},"running":{"type":"integer"}},"description":"Summary of subtask states for the pipeline"},"terminated":{"type":"boolean","description":"Has the pipeline been terminated?"},"triggering_pipeline_id":{"type":"integer","description":"Triggering pipeline ID"},"user":{"type":"object","required":["id","name"],"description":"Details of the user who created the pipeline","properties":{"id":{"type":"integer","description":"User ID of the pipeline creator"},"name":{"type":"string","description":"User name of the pipeline creator"}}}}}},"pagination":{"type":"object","description":"Pagination information","properties":{"current_page":{"description":"The current page number","type":"integer"},"total_pages":{"description":"The total number of pages","type":"integer"},"total_records":{"description":"The total number of records","type":"integer"},"per_page":{"description":"The number of records per page","type":"integer"},"type":{"default":"page","description":"The type of the pagination","enum":["page"],"type":"string"}},"required":["total_records","current_page","total_pages","type"]},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["status","data","pagination"],"type":"object"}}},"description":"List of pipelines"},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"summary":"List pipelines","tags":["Pipelines"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"}},"\/api\/v3\/pipelines\/{id}":{"get":{"description":"Get a pipeline by ID.","parameters":[{"description":"Pipeline ID to retrieve.","in":"path","name":"id","required":true,"schema":{"type":"integer"}}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"object","required":["aborted","can_be_terminated","created","kick_off","name","pipeline","subtasks","summary","terminated"],"properties":{"aborted":{"type":"boolean","description":"Has the pipeline been aborted?"},"can_be_terminated":{"type":"boolean","description":"Can the pipeline be terminated?"},"created":{"type":"number","description":"Creation timestamp (ms since epoch)"},"evidence":{"type":"object","required":["id","name"],"nullable":true,"description":"Details of the evidence the pipeline relates to","properties":{"id":{"type":"integer","description":"Evidence ID the pipeline relates to"},"name":{"type":"string","description":"Evidence name the pipeline relates to"}}},"kick_off":{"type":"array","description":"Details of the alert that kicked off the pipeline","items":{"type":"string"}},"name":{"type":"string","description":"Pipeline name"},"pipeline":{"type":"object","required":["id","type"],"description":"Details of the pipeline","properties":{"id":{"type":"integer","description":"Pipeline ID"},"type":{"type":"string","description":"Type of pipeline","enum":["processing","acquisition","healthcheck","inventory","investigation_kicker","accountdiscovery","analysis","remote_action"]}}},"project":{"type":"object","required":["id","name"],"description":"Details of the project the pipeline relates to","properties":{"id":{"type":"integer","description":"Project ID the pipeline relates to"},"name":{"type":"string","description":"Project name the pipeline relates to"}}},"subtasks":{"type":"array","description":"Details of the subtasks for the pipeline","items":{"type":"object","required":["execution_duration","finish_time","name","name_key","notification_level","progress_text","start_time","state"],"properties":{"execution_duration":{"type":"integer","description":"Execution duration in seconds"},"finish_time":{"type":"number","description":"Finish time (ms since epoch)"},"name":{"type":"string","description":"Subtask name"},"name_key":{"type":"string","description":"Subtask name key"},"notification_level":{"type":"string","description":"Notification level"},"progress_text":{"type":"array","items":{"type":"string"},"description":"Progress text"},"start_time":{"type":"number","description":"Start time (ms since epoch)"},"state":{"type":"string","description":"State of the subtask","enum":["PENDING","RUNNING","SUCCESS","FAILURE","CANCELLED"]},"total_stages":{"type":"integer","nullable":true,"description":"Total stages"}}}},"summary":{"type":"object","required":["total","success","failure","pending","cancelled","running"],"properties":{"total":{"type":"integer"},"success":{"type":"integer"},"failure":{"type":"integer"},"pending":{"type":"integer"},"cancelled":{"type":"integer"},"running":{"type":"integer"}},"description":"Summary of subtask states for the pipeline"},"terminated":{"type":"boolean","description":"Has the pipeline been terminated?"},"triggering_pipeline_id":{"type":"integer","description":"Triggering pipeline ID"},"user":{"type":"object","required":["id","name"],"description":"Details of the user who created the pipeline","properties":{"id":{"type":"integer","description":"User ID of the pipeline creator"},"name":{"type":"string","description":"User name of the pipeline creator"}}}}},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["status","data"],"type":"object"}}},"description":"Successful response with pipeline data."},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"summary":"Get pipeline","tags":["Pipelines"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"},"patch":{"description":"Update the attributes of a pipeline. Can also be used to cancel a pipeline, by updating the 'aborted' attribute to true.","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer"},"description":"ID of the pipeline to update."}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["aborted"],"properties":{"aborted":{"type":"boolean","description":"Set to true to cancel the pipeline","enum":[true]}}}}}},"responses":{"200":{"content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"data":{"type":"object","properties":{"pipeline_id":{"type":"integer","description":"The ID of the updated pipeline."}}},"status":{"type":"string","enum":["success"],"description":"The status of the response, in this context, the value will be \"success\".","default":"success"}}}}},"description":"The data containing the ID of the updated pipeline."},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"summary":"Update pipeline","tags":["Pipelines"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"}},"\/api\/v3\/pipelines\/{id}\/logs":{"get":{"description":"Get the logs for a pipeline by ID.","parameters":[{"description":"Pipeline ID to retrieve logs for.","in":"path","name":"id","required":true,"schema":{"type":"integer"}}],"responses":{"200":{"description":"Zip file with logs","content":{"application\/zip":{"schema":{"type":"string","format":"binary"}}}},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"summary":"Get pipeline logs","tags":["Pipelines"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"}},"\/api\/v3\/pipelines\/rerun":{"post":{"description":"Either rerun all the pipelines for a project or a single pipeline with a given ID.","requestBody":{"content":{"application\/json":{"schema":{"type":"object","properties":{"pipeline_id":{"type":"integer","description":"ID of the pipeline to rerun."},"project_id":{"type":"integer","description":"ID of the project to rerun all pipelines"}}}}}},"responses":{"201":{"content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"data":{"type":"object","properties":{"pipeline_ids":{"type":"array","items":{"type":"integer"},"description":"The IDs of the reran pipeline(s)."}}},"status":{"type":"string","enum":["success"],"description":"The status of the response, in this context, the value will be \"success\".","default":"success"}}}}},"description":"Response containing the IDs of the reran pipeline(s)."},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"summary":"Rerun pipeline","tags":["Pipelines"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"}},"\/api\/v3\/pipelines\/cancel-all":{"patch":{"description":"Cancel all running pipelines.","responses":{"200":{"content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"data":{"type":"object","required":["message","ids"],"properties":{"message":{"type":"string","description":"Message indicating the number of pipelines that have been cancelled."},"ids":{"type":"array","items":{"type":"integer"},"description":"The IDs of the cancelled pipeline(s)."}}},"status":{"type":"string","enum":["success"],"description":"The status of the response, in this context, the value will be \"success\".","default":"success"}}}}},"description":"Response containing the IDs of the cancelled pipeline(s)."},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"summary":"Cancel all pipelines","tags":["Pipelines"],"x-Required Roles":["Administrator"],"x-Feature Lifecycle":"beta"}},"\/api\/v3\/settings\/nfs":{"patch":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator"],"summary":"Update NFS settings","description":"Update NFS settings.","tags":["Settings"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","oneOf":[{"required":["aws_nfs_config"]},{"required":["gcp_nfs_config"]},{"required":["azure_nfs_config"]}],"properties":{"aws_nfs_config":{"type":"object","description":"AWS NFS settings.","properties":{"efs_ip":{"type":"string","description":"The IP address of the NFS server."},"efs_filesystem_id":{"type":"string","description":"The file system ID of the NFS server."},"efs_accesspoint_id":{"type":"string","description":"The access point ID of the NFS server."}}},"gcp_nfs_config":{"type":"object","description":"GCP NFS settings.","required":["filestore_ip","filestore_name"],"properties":{"filestore_ip":{"type":"string","description":"The IP address of the NFS server."},"filestore_name":{"type":"string","description":"The NFS server name."}}},"azure_nfs_config":{"type":"object","description":"Azure NFS settings.","required":["azure_storage_name","azure_storage_share"],"properties":{"azure_storage_name":{"type":"string","description":"The storage account name of the NFS server."},"azure_storage_share":{"type":"string","description":"The storage share name of the NFS server."}}}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","enum":["error"],"description":"The status of the response, in this context, the value will be \"error\".","default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"A response indicating the NFS was successfully mounted.","content":{"application\/json":{"schema":{"type":"object","required":["status"],"properties":{"status":{"type":"string","enum":["success"],"description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting.","properties":{"task_id":{"type":"string","description":"The task ID to track the update"}}}}}}}}}}},"\/api\/v3\/license":{"get":{"description":"Get the license information for the current instance of Cado.","parameters":[],"responses":{"200":{"content":{"application\/json":{"schema":{"type":"object","required":["data","status"],"properties":{"data":{"type":"object","description":"The license data for the current instance of Cado.","required":["license"],"properties":{"license":{"type":"object","required":["customer_id","dev_license","issue_date","level","expiry_date","signature"],"description":"The license data, if it exists.","properties":{"customer_id":{"type":"string","description":"A unique identifier for the customer."},"dev_license":{"type":"boolean","description":"A boolean value indicating if the license is a development license."},"issue_date":{"type":"string","description":"The date the license was issued."},"level":{"type":"string","description":"The license level","enum":["FULL","COMMUNITY","RESTRICTED"]},"expiry_date":{"type":"string","description":"The date the license will expire."},"signature":{"type":"string","description":"The unique signature of the license."}}}}},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}}}}},"description":"A response indicating the license data was successfully retrieved."},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"summary":"Get license","tags":["Licenses"],"x-Admin Only":"no","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"}},"\/api\/v3\/license\/upload":{"post":{"description":"Upload a license file to the current instance of Cado.","requestBody":{"content":{"multipart\/form-data":{"schema":{"type":"object","required":["file"],"properties":{"file":{"type":"string","format":"binary","description":"The license file to upload."}}}}}},"responses":{"200":{"content":{"application\/json":{"schema":{"type":"object","required":["data","status"],"properties":{"data":{"type":"object","required":["message","file_id"],"description":"The data returned by the API.","properties":{"file_id":{"description":"The unique identifier of the uploaded license file.","type":"string"}}},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}}}}},"description":"A response indicating the license was successfully uploaded."},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"summary":"Upload license","tags":["Licenses"],"x-Admin Only":"yes","x-Required Roles":["Administrator"],"x-Feature Lifecycle":"beta"}},"\/api\/v3\/settings\/scripts":{"get":{"summary":"Get a list of scripts that can be executed on SSM enabled devices","description":"Retrieve a list of scripts that can be executed on SSM enabled devices, either get all or can search based on name and operating system.","parameters":[{"name":"name","in":"query","description":"The name of the script to search for.","required":false,"schema":{"type":"string"}},{"name":"operating_system","in":"query","description":"The operating system of the device that the script will be run on.","required":false,"schema":{"type":"string"}},{"name":"page","in":"query","required":false,"description":"The page number to get notifications for","schema":{"type":"integer","default":1}},{"name":"per_page","in":"query","required":false,"description":"The number of notifications to get per page","schema":{"type":"integer","default":10}}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"array","items":{"type":"object","description":"A script that can be executed on SSM enabled devices.","required":["id","name","description","os","script_input_uri","script_output_uri","created_datetime","updated_datetime"],"properties":{"id":{"type":"integer","description":"The resource ID for the script."},"name":{"type":"string","description":"The name of the script."},"description":{"type":"string","description":"A description of the script."},"os":{"type":"string","description":"The operating system of the device that the script will be run on.","enum":["linux","windows"]},"script_input_uri":{"type":"string","description":"The value of the script IO input. This should be a S3 URI of where to download from. Should be identified in the script using ${INPUT}."},"script_output_uri":{"type":"string","description":"The value of the script IO output. This should be a path in the S3 Cado default bucket. Should be identified in the script using ${OUTPUT}.","example":"\/folder\/filename"},"created_datetime":{"type":"number","description":"The timestamp of when the script was created."},"updated_datetime":{"type":"number","description":"The timestamp of when the script was last updated."}}}},"pagination":{"type":"object","description":"Pagination information","required":["type","total_records","current_page","total_pages"],"properties":{"type":{"type":"string","enum":["page"],"default":"page","description":"A string indicating the type of pagination supported by the API. In this context, the value will be \"page\"."},"total_records":{"type":"integer","description":"An integer representing the total amount of data we're paging."},"current_page":{"type":"integer","description":"An integer representing the current page of data (we use this to work out next and previous pages). NOTE: this is 1-indexed (i.e. it starts at 1)."},"total_pages":{"type":"integer","description":"An integer representing the total number of pages."},"per_page":{"type":"integer","description":"An integer representing the number of records per page."}}},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["data","status","pagination"],"type":"object"}}},"description":"A reponse indicating that scripts have been successfully retrieved."},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"tags":["Settings"],"x-Required Roles":["Administrator","Lead Analyst"],"x-Feature Lifecycle":"beta"},"post":{"summary":"Create a new script to be executed on SSM enabled devices","description":"Create a new script which will be run on SSM enabled devices. A script can have \"input\" or \"output\" variables associated with it which will specify where to copy from, or copy files to respectively. Returns the resource ID of the created script.","x-Required Roles":["Administrator","Lead Analyst"],"x-Feature Lifecycle":"beta","security":[{"bearerAuth":[]}],"tags":["Settings"],"parameters":[],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["name","description","os","script"],"properties":{"name":{"type":"string","description":"The name of script being created."},"description":{"type":"string","description":"A brief description of the script being created."},"os":{"type":"string","description":"The operating system of the device that the script will be run on. This can have a value of \"linux\" or \"windows\".","default":"linux","enum":["linux","windows"]},"script":{"type":"string","description":"The contents of the script being created."},"script_input_uri":{"type":"string","description":"The value of the script IO input. This should be a S3 URI of where to download from. Should be identified in the script using ${INPUT}."},"script_output_uri":{"type":"string","description":"The value of the script IO output. This should be a path in the S3 Cado default bucket. Should be identified in the script using ${OUTPUT}.","example":"\/folder\/filename"}}}}}},"responses":{"200":{"description":"The resource ID of the script created.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"enum":["success"],"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","description":"The data returned containing the resource ID of the script created.","schema":null,"required":["script_id"],"properties":{"script_id":{"type":"integer","description":"The resource ID of the script created."}}}}}}}},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}}}},"\/api\/v3\/settings\/scripts\/{script_id}":{"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst"],"summary":"Get in-depth script information","description":"Get in-depth script information by its ID.","tags":["Settings"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"script_id","in":"path","required":true,"description":"ID of the script being queried.","schema":{"type":"integer","example":1}}],"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","enum":["error"],"description":"The status of the response, in this context, the value will be \"error\".","default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Successfully retrieved script.","content":{"application\/json":{"schema":{"type":"object","required":["status"],"properties":{"data":{"type":"object","description":"Detailed information on the script being queried.","required":["id","name","description","os","script","script_input_uri","script_output_uri","created_datetime","updated_datetime"],"properties":{"id":{"type":"integer","description":"The resource ID for the script."},"name":{"type":"string","description":"The name of the script."},"description":{"type":"string","description":"A brief description of the script."},"os":{"type":"string","description":"The operating system of the device that the script will be run on.","enum":["linux","windows"]},"script":{"type":"string","description":"The contents of the script."},"script_input_uri":{"type":"string","description":"The value of the script IO input. This should be a S3 URI of where to download from. Should be identified in the script using ${INPUT}."},"script_output_uri":{"type":"string","description":"The value of the script IO output. This should be a path in the S3 Cado default bucket. Should be identified in the script using ${OUTPUT}.","example":"\/folder\/filename"},"created_datetime":{"type":"number","description":"The timestamp of when the script was created."},"updated_datetime":{"type":"number","description":"The timestamp of when the script was last updated."}}},"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"default":"success"}}}}}}}},"patch":{"summary":"Update a script","description":"Update an existing script which will be run on SSM-enabled devices. A script can have \"input\" or \"output\" variables associated with it which will specify where to copy from, or copy files to respectively. Returns details of the updated script.","x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst"],"tags":["Settings"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"script_id","in":"path","required":true,"schema":{"type":"integer"},"description":"ID of the script you want to update."}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","properties":{"name":{"type":"string","description":"The name of script."},"description":{"type":"string","description":"A brief description of the script."},"script":{"type":"string","description":"The contents of the script."},"script_input_uri":{"type":"string","description":"The value of the script IO input. This should be a S3 URI of where to download from. Should be identified in the script using ${INPUT}."},"script_output_uri":{"type":"string","description":"The value of the script IO output. This should be a path in the S3 Cado default bucket. Should be identified in the script using ${OUTPUT}.","example":"\/folder\/filename"}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Successfully updated the script.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"default":"success"},"data":{"type":"object","description":"The data being returned containing details of the updated script.","required":["id","name","description","os","script","script_input_uri","script_output_uri"],"properties":{"id":{"type":"integer","description":"The ID of the updated script."},"name":{"type":"string","description":"The name of the updated script."},"description":{"type":"string","description":"A brief description of the updated script."},"os":{"type":"string","description":"The operating system of the device that the updated script will be run on. This can have a value of \"linux\" or \"windows\".","default":"linux","enum":["linux","windows"]},"script":{"type":"string","description":"The contents of the updated script."},"script_input_uri":{"type":"string","description":"The value of the script IO input. This should be a S3 URI of where to download from. Should be identified in the script using ${INPUT}."},"script_output_uri":{"type":"string","description":"The value of the script IO output. This should be a path in the S3 Cado default bucket. Should be identified in the script using ${OUTPUT}.","example":"\/folder\/filename"}}}}}}}}}},"delete":{"summary":"Delete a script from the scripts library","description":"Delete a script from the scripts library.","x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst"],"tags":["Settings"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"script_id","in":"path","required":true,"description":"ID of the script to delete.","schema":{"type":"integer","example":1}}],"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","enum":["error"],"description":"The status of the response, in this context, the value will be \"error\".","default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Successfully deleted script","content":{"application\/json":{"schema":{"type":"object","required":["status"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"default":"success"}}}}}}}}},"\/api\/v3\/import\/microsoft365\/ual":{"post":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Import a set of Microsoft 365 Unified Audit Logs","description":"Import a set of Microsoft 365 Unified Audit Logs.","tags":["Import from Microsoft 365"],"security":[{"bearerAuth":[]}],"parameters":[],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["start_time","end_time","credentials","project_id"],"properties":{"start_time":{"description":"The start time of the logs to import. This should be in Unix Epoch format.","type":"integer"},"end_time":{"description":"The end time of the logs to import. This should be in Unix Epoch format.","type":"integer"},"credentials":{"description":"The credentials to use to authenticate with the Microsoft 365 API.","type":"string"},"workload":{"description":"The Microsoft 365 workload to import logs from.","type":"string","default":"all","enum":["exchange","sharepoint","aad","onedrive","defender","all"]},"user_ids":{"description":"A list of user IDs to import logs for. If not provided, logs for all users will be imported.","type":"array","items":{"type":"string"}},"ip_addresses":{"description":"A list of IP addresses to import logs for. If not provided, logs for all IP addresses will be imported.","type":"array","items":{"type":"string"}},"project_id":{"description":"The ID of associated Cado project logs will be imported into.","type":"integer"}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","default":"error","enum":["error"]},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"A new pipeline object is returned, indicating a successful kick-off of a pipeline. You can see the <a href=\"https:\/\/cado-security.github.io\/api-reference\/#tag\/Pipelines\/paths\/~1api~1v3~1pipelines~1{id}\/get\">Pipeline API<\/a> documentation for information on getting details about this pipeline.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"enum":["success"],"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","description":"The data containing the new processing pipeline.","schema":null,"required":["pipeline_id"],"properties":{"pipeline_id":{"type":"integer","description":"The ID of the import pipeline created."}}}}}}}}}}},"\/api\/v3\/import\/gcp\/gcs\/buckets":{"get":{"summary":"Browse a list of GCS buckets","description":"Browse a list of GCS buckets inside a specific GCP account.","parameters":[{"name":"account_name","in":"query","required":true,"schema":{"type":"string"},"description":"The alias of the chosen GCP account to browse. See the <a href=\"#\">Clouds API<\/a> documentation for more info on obtaining the account name for a specific GCP account."},{"name":"page","in":"query","required":true,"schema":{"type":"integer"},"description":"The page of items to retrieve."},{"name":"gcp_project","in":"query","required":true,"schema":{"type":"string"},"description":"The GCP project ID to filter by."},{"name":"per_page","in":"query","required":true,"schema":{"type":"integer","default":10},"description":"The amount of items to be given per page. If left blank, the default will be 10."}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"array","items":{"type":"object","description":"A GCS bucket","required":["name","location"],"properties":{"name":{"type":"string","description":"The name of the GCS bucket."},"location":{"type":"string","description":"The GCP location\/zone of the GCS bucket."},"labels":{"type":"object","description":"The labels of the GCS bucket."},"storage_class":{"type":"string","description":"The storage class of the GCS bucket."}}}},"pagination":{"$ref":"#\/components\/schemas\/pagination"},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["data","status","pagination"],"type":"object"}}},"description":""},"default":{"$ref":"#\/components\/responses\/default"}},"security":[{"bearerAuth":[]}],"tags":["Import from GCP"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"}},"\/api\/v3\/import\/gcp\/gcs\/objects":{"get":{"summary":"Browse a list of GCS bucket objects","description":"Browse a list of GCS bucket objects inside a specific GCP account.","parameters":[{"name":"account_name","in":"query","required":true,"schema":{"type":"string"},"description":"The alias of the chosen GCP account to browse. See the <a href=\"#\">Clouds API<\/a> documentation for more info on obtaining the account_name for a specific GCP account."},{"name":"page","in":"query","required":true,"schema":{"type":"integer"},"description":"The page of items to retrieve."},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":10},"description":"The maximum amount of results to be given per query. The query returns anywhere between MAX\/2 and MAX results due to how the GCS API operates. If left blank, the default will be 10."},{"name":"bucket_name","in":"query","required":true,"description":"The bucket to get contents from","schema":{"type":"string"}},{"name":"prefix","in":"query","required":false,"description":"The prefix to filter the objects by. Must end in a \"\/\"","schema":{"type":"string"}},{"name":"gcp_project","in":"query","required":true,"schema":{"type":"string"},"description":"The GCP project ID to filter by."}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"array","items":{"type":"object","description":"An GCS bucket object","required":["name","type","last_modified","size","storage_class"],"properties":{"name":{"type":"string","description":"The filename of the GCS object"},"last_modified":{"type":"number","description":"The timestamp of the last modification of the GCS object"},"size":{"type":"integer","description":"The size of the GCS object in bytes"}}}},"pagination":{"$ref":"#\/components\/schemas\/pagination"},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["data","status","pagination"],"type":"object"}}},"description":""},"default":{"$ref":"#\/components\/responses\/default"}},"security":[{"bearerAuth":[]}],"tags":["Import from GCP"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"}},"\/api\/v3\/import\/gcp\/gcs":{"post":{"summary":"Create GCS bucket acquire task","description":"Create a new task to acquiring new evidence from GCS bucket. Can acquire the entire GCS bucket or a specific file.","tags":["Import from GCP"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta","security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["bucket","project_id","account_name","gcp_project","prefix"],"properties":{"project_id":{"type":"integer","description":"The project id to import the evidence into."},"bucket":{"type":"string","description":"The name of the bucket to acquire from."},"gcp_project":{"type":"string","description":"The project id the bucket resides within"},"file_names":{"type":"array","items":{"type":"string"},"description":"The name of the file to acquire. If left blank, the entire bucket will be acquired."},"prefix":{"type":"string","description":"The prefix to filter the objects by. Must end in a \"\/\""},"account_name":{"type":"string","description":"The GCP credentials alias that belongs to the account you want to retrieve buckets from."}}}}}},"responses":{"200":{"description":"Task created","content":{"application\/json":{"schema":{"required":["data","status"],"properties":{"status":{"enum":["success"],"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","required":["pipeline_ids"],"properties":{"pipeline_ids":{"type":"array","items":{"type":"object","required":["id"],"properties":{"id":{"type":"integer"}}}}}}}}}}},"default":{"$ref":"#\/components\/responses\/default"}}}},"\/api\/v3\/remote-actions\/run-script":{"post":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst"],"summary":"Run a Saved Script on a SSM enabled EC2 instance","description":"Run a Saved Script on a SSM enabled EC2 instance.","tags":["Remote Actions"],"security":[{"bearerAuth":[]}],"parameters":[],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["script_id","cloud_id","project_id","instance_id","region"],"properties":{"script_id":{"type":"integer","description":"The ID of the script to be run on the EC2 via SSM."},"cloud_id":{"type":"string","description":"AWS Credentials Alias."},"project_id":{"type":"integer","description":"Cado Project ID."},"region":{"type":"string","description":"AWS Region of the EC2."},"instance_id":{"type":"string","description":"EC2 Instance ID."}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","default":"error","enum":["error"]},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"A new pipeline object is returned, indicating a successful kick-off of a pipeline. You can see the <a href=\"#\">Pipeline API<\/a> documentation for information on getting details about this pipeline.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"enum":["success"],"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","description":"The data containing the new pipeline ID.","schema":null,"required":["pipeline_id"],"properties":{"pipeline_id":{"type":"integer","description":"The numerical ID assigned to the pipeline."}}}}}}}}}}},"\/api\/v3\/accounts":{"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Retrieve Accounts","description":"Retrieve all the accounts added to the platform.","parameters":[{"name":"account_name","in":"query","required":false,"schema":{"type":"string"},"description":"Filter by account name."},{"name":"type","in":"query","required":false,"schema":{"type":"array","items":{"type":"string","enum":["aws","gcp","azure","crowdstrike","sentinelone","defender","microsoft_saas","google_workspace"]}},"description":"Filter by account type. Multiple types can be specified."},{"name":"account_check_result","in":"query","required":false,"schema":{"type":"string","enum":["success","failure","cancelled","no_checks"]},"description":"Filter by recent Account Check result."},{"name":"group_id","in":"query","required":false,"schema":{"type":"integer"},"description":"Filter by roles assigned to the group."},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1},"description":"Which page of cloud credentials to return."},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":10},"description":"How many cloud credentials per page."}],"tags":["Accounts"],"security":[{"bearerAuth":[]}],"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Successfully got account credentials.","content":{"application\/json":{"schema":{"type":"object","required":["status","data","pagination"],"properties":{"pagination":{"type":"object","properties":{"current_page":{"description":"The current page number","type":"integer"},"total_pages":{"description":"The total number of pages","type":"integer"},"total_records":{"description":"The total number of records","type":"integer"},"per_page":{"description":"The number of records per page","type":"integer"},"type":{"default":"page","description":"The type of the pagination","enum":["page"],"type":"string"}},"required":["total_records","current_page","total_pages","type"]},"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"default":"success"},"data":{"type":"array","description":"A list of accounts.","items":{"type":"object","required":["id","account_name","type","account_check_id"],"properties":{"id":{"type":"integer","description":"The unique ID of the account."},"account_name":{"type":"string","description":"The account name"},"type":{"type":"string","enum":["aws","gcp","azure","crowdstrike","sentinelone","defender","microsoft_saas","google_workspace"],"description":"The account type"},"public_identifier":{"type":"string","description":"The public identifier for the account."},"account_check_id":{"type":"integer","nullable":true,"description":"The Account Check ID associated with the account (if applicable)."}}}}}}}}}}},"post":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator"],"summary":"Add Accounts","description":"Add an account to the platform.","tags":["Accounts"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["account_name","account_type"],"properties":{"account_name":{"type":"string","description":"The alias for the account credentials being added. This must be unique."},"account_type":{"type":"string","enum":["aws","gcp","azure","crowdstrike","sentinelone","defender","microsoft_saas","google_workspace"],"description":"The account service provider for the saved credentials."},"default_creds":{"type":"boolean","description":"Whether to use the same identity as the Cado Platform. This is only applicable for GCP and Azure deployments, and credentials must not be passed if this is set."},"credential_data":{"type":"object","description":"The account credentials to be added.","oneOf":[{"type":"object","title":"Aws Role ARN","description":"An object containing the AWS role. This should be in an ARN format.","required":["role"],"properties":{"role":{"type":"string","example":"arn:aws:iam::12345678910:role\/myRole","description":"An AWS role to be added to the platform."}}},{"type":"object","title":"Aws Keys","description":"An object containing key-based credentials.","required":["access_key","secret_key"],"properties":{"access_key":{"type":"string","description":"The access key for the key-based credentials."},"secret_key":{"type":"string","description":"The secret key for the key-based credentials."}}},{"type":"object","title":"GCP Service Account","description":"An object containing the GCP Service Account credentials.","required":["project_id","type","client_id","auth_uri","client_email","private_key","private_key_id","auth_provider_x509_cert_url","client_x509_cert_url","token_uri"],"properties":{"project_id":{"type":"string","description":"The GCP Project ID for the GCP Service Account credentials."},"type":{"type":"string","description":"The type of the GCP Service Account credentials."},"client_id":{"type":"string","description":"The client ID for the GCP Service Account credentials."},"client_email":{"type":"string","description":"The client email for the GCP Service Account credentials."},"auth_uri":{"type":"string","description":"The auth URI for the GCP Service Account credentials."},"token_uri":{"type":"string","description":"The token URI for the GCP Service Account credentials."},"private_key":{"type":"string","description":"The private key for the GCP Service Account credentials."},"private_key_id":{"type":"string","description":"The private key ID for the GCP Service Account credentials."},"auth_provider_x509_cert_url":{"type":"string","description":"The auth provider x509 certificate URL for the GCP Service Account credentials."},"client_x509_cert_url":{"type":"string","description":"The client x509 certificate URL for the GCP Service Account credentials."},"universe_domain":{"type":"string","description":"The universe domain for the GCP Service Account credentials."}}},{"type":"object","title":"GCP Workload Identity Federation (WIF)","description":"An object containing the GCP Workload Identity Federation (WIF) credentials.","required":["type","audience","subject_token_type","service_account_impersonation_url","token_url","credential_source"],"properties":{"universe_domain":{"type":"string","description":"The universe domain of the GCP Workload Identity Federation (WIF) credentials."},"type":{"type":"string","description":"The type of the GCP Workload Identity Federation (WIF) credentials."},"audience":{"type":"string","description":"The audience for the GCP Workload Identity Federation (WIF) credentials."},"subject_token_type":{"type":"string","description":"The subject for the GCP Workload Identity Federation (WIF) credentials."},"service_account_impersonation_url":{"type":"string","description":"The service account impersonation URL for the GCP Workload Identity Federation (WIF) credentials."},"token_url":{"type":"string","description":"The token URL for the GCP Workload Identity Federation (WIF) credentials."},"credential_source":{"type":"object","description":"The credential source for the GCP Workload Identity Federation (WIF) credentials."}}},{"type":"object","title":"Azure Service Principal","description":"An object containing the Azure Service Principal credentials.","required":["client_id","client_secret","tenant_id"],"properties":{"client_id":{"type":"string","description":"Client ID of the Azure Credentials."},"client_secret":{"type":"string","description":"Client Secret of the Azure Credentials."},"tenant_id":{"type":"string","description":"Tenant ID of the Azure Credentials."}}},{"type":"object","title":"SentinelOne XDR","description":"An object containing SentinelOne XDR credentials.","required":["endpoint","token"],"properties":{"endpoint":{"type":"string","description":"The configured endpoint URL for SentinelOne XDR."},"token":{"type":"string","description":"The API token"}}},{"type":"object","title":"CrowdStrike XDR","description":"An object containing CrowdStrike XDR credentials.","required":["endpoint","client_id","client_secret"],"properties":{"endpoint":{"type":"string","description":"The configured endpoint URL for CrowdStrike."},"client_id":{"type":"string","description":"The client ID for CrowdStrike."},"client_secret":{"type":"string","description":"The client secret for CrowdStrike."}}},{"type":"object","title":"Defender XDR","description":"An object containing Defender XDR credentials.","required":["endpoint","client_id","client_secret","tenant_id"],"properties":{"endpoint":{"type":"string","description":"The configured endpoint URL for Defender."},"client_id":{"type":"string","description":"The client ID for Defender."},"client_secret":{"type":"string","description":"The client secret for Defender."},"tenant_id":{"type":"string","description":"The tenant ID for Defender."}}},{"type":"object","title":"Microsoft SaaS","required":["organization","tenant_id","client_id","client_secret"],"properties":{"organization":{"type":"string","description":"The Microsoft SaaS organization."},"tenant_id":{"type":"string","description":"The tenant ID for Microsoft SaaS."},"client_id":{"type":"string","description":"The client ID for Microsoft SaaS."},"client_secret":{"type":"string","description":"The client secret for Microsoft SaaS."}}},{"type":"object","title":"Google Workspace","description":"An object containing Google Workspace credentials. These should be copied directly from the console.","required":["impersonation_email","credentials"],"properties":{"impersonation_email":{"type":"string"},"credentials":{"type":"object"}}}]}}}}}},"responses":{"201":{"description":"Successfully added account credentials.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"enum":["success"],"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","description":"The data returned containing the account_name of the created account.","schema":null,"required":["account_name"],"properties":{"account_name":{"type":"string","description":"the account_name of the created account."}}}}}}}},"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}}}}},"\/api\/v3\/accounts\/{account_name}":{"delete":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator"],"summary":"Delete Account","description":"Deletes an account from the platform.","parameters":[{"name":"account_name","in":"path","required":true,"schema":{"type":"string"},"description":"The name of the account to delete."}],"tags":["Accounts"],"security":[{"bearerAuth":[]}],"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Successfully deleted account credentials.","content":{"application\/json":{"schema":{"type":"object","required":["status"],"properties":{"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}}}}}}}}},"\/api\/v3\/accounts\/discovery\/aws":{"post":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator"],"externalDocs":{"description":"AWS Organizations Feature Documentation","url":"https:\/\/docs.cadosecurity.com\/cado\/deploy\/cross\/aws-organizations"},"summary":"Kick off an AWS Organization Account Discovery","description":"Kick off an account discovery for AWS using AWS Organizations","tags":["Accounts"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["organization_account_name","iam_role_name"],"properties":{"organization_account_name":{"type":"string","description":"The name of the account that is assumed to list accounts in an organization. This must have the orgs:ListAccounts permissions and added to the Cado platform."},"iam_role_name":{"type":"string","pattern":"\/arn:aws:iam::\/i","description":"The name of the IAM role the platform will try to assume in discovered accounts. This is not the full ARN."}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Successfully kick off an AWS Organization Account Discovery","content":{"application\/json":{"schema":{"type":"object","required":["status"],"properties":{"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"},"data":{"type":"object","description":"The data containing the new account discovery pipeline.","schema":null,"required":["pipeline_id"],"properties":{"pipeline_id":{"type":"integer","description":"The numerical ID assigned to the pipeline."}}}}}}}}}}},"\/api\/v3\/notifications\/{notification_id}":{"patch":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Update a notification to be read or unread","description":"Update a notification to be read or unread.","tags":["Notifications"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"notification_id","in":"path","required":true,"description":"Id of the notification to update","schema":{"type":"integer","example":1}}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["is_viewed"],"properties":{"is_viewed":{"type":"boolean","description":"Whether a notification has been viewed or not"}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Successfully updated notification","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"default":"success"},"data":{"type":"object","required":["id","message","level","notification_type","is_viewed","created"],"properties":{"id":{"type":"integer","description":"The unique id of the notification model instance"},"is_viewed":{"type":"boolean","description":"Whether the notification has been viewed or not"},"message":{"type":"string","description":"The message of the notification"},"created":{"type":"number","description":"Creation time as a Unix timestamp"},"level":{"type":"string","description":"The level of the notification"},"project_id":{"type":"integer","description":"The unique id of the project"},"evidence_id":{"type":"integer","description":"The unique id of the evidence instance"},"notification_type":{"type":"string","enum":["System","Acquisition","Processing","Authentication","Other"],"description":"The type of notification"}}}}}}}}}}},"\/api\/v3\/notifications":{"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Get a list of notifications","description":"Get a notification information.","tags":["Notifications"],"parameters":[{"name":"project_id","in":"query","required":false,"description":"The unique id of the project to get notifications for","schema":{"type":"integer"}},{"name":"evidence_id","in":"query","required":false,"description":"The unique id of the evidence item to get notifications for","schema":{"type":"integer"}},{"name":"is_viewed","in":"query","required":false,"description":"Whether to get viewed or not viewed notifications","schema":{"type":"boolean"}},{"name":"from_date","in":"query","required":false,"description":"The start date to get notifications from","schema":{"type":"integer"}},{"name":"to_date","in":"query","required":false,"description":"The end date to get notifications","schema":{"type":"integer"}},{"name":"page","in":"query","required":true,"description":"The page number to get notifications for","schema":{"type":"integer"}},{"name":"per_page","in":"query","required":true,"description":"The number of notifications to get per page","schema":{"type":"integer"}},{"name":"notification_type","in":"query","required":false,"description":"The type of notification to get i.e System, Acquisition etc","schema":{"type":"string"}},{"name":"level","in":"query","required":false,"description":"The level of the notification to get i.e Info, Warning, Error","schema":{"type":"string","enum":["Info","Warning","Error"]}},{"name":"include_deleted","in":"query","required":false,"description":"Whether to get notifications that are associated with a project that has been deleted","schema":{"type":"boolean"}}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Retrieved a list of notifications","content":{"application\/json":{"schema":{"type":"object","required":["status","data","pagination"],"properties":{"pagination":{"type":"object","properties":{"current_page":{"description":"The current page number","type":"integer"},"total_pages":{"description":"The total number of pages","type":"integer"},"total_records":{"description":"The total number of records","type":"integer"},"per_page":{"description":"The number of records per page","type":"integer"},"type":{"default":"page","description":"The type of the pagination","enum":["page"],"type":"string"}},"required":["total_records","current_page","total_pages","type"]},"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"default":"success"},"data":{"type":"array","items":{"type":"object","required":["id","message","level","notification_type","is_viewed","created"],"properties":{"id":{"type":"integer","description":"The unique id of the notification model instance"},"is_viewed":{"type":"boolean","description":"Whether the notification has been viewed or not"},"message":{"type":"string","description":"The message of the notification"},"created":{"type":"number","description":"Creation time as a Unix timestamp"},"level":{"type":"string","description":"The level of the notification"},"project_id":{"type":"integer","description":"The unique id of the project"},"evidence_id":{"type":"integer","description":"The unique id of the evidence instance"},"project_name":{"type":"string","description":"The name of the project"},"evidence_name":{"type":"string","description":"The name of the evidence"},"notification_type":{"type":"string","enum":["System","Acquisition","Processing","Authentication","Other"],"description":"The type of notification"}}}}}}}}},"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","enum":["error"],"description":"The status of the response, in this context, the value will be \"error\".","default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}}}}},"\/api\/v3\/platform":{"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Platform information","description":"Information about the platform, update availability, etc.","tags":["Platform"],"security":[{"bearerAuth":[]}],"parameters":[],"responses":{"200":{"description":"Platform information","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success","enum":["success"]},"data":{"type":"object","required":["deployment_details","instance_utilization","warnings","latest_boot"],"properties":{"instance_utilization":{"type":"object","description":"Instance utilization information","required":["disk","cpu_percent","memory"],"properties":{"disk":{"description":"Disk information in GB","required":["total_space","used_space","free_space"],"type":"object","properties":{"total_space":{"type":"integer"},"used_space":{"type":"integer"},"free_space":{"type":"integer"},"raw_disk":{"type":"string"}}},"cpu_percent":{"type":"number","description":"CPU usage percentage"},"memory":{"type":"object","description":"Memory information in Mb","required":["available","total"],"properties":{"available":{"type":"number"},"total":{"type":"number"}}}}},"deployment_details":{"type":"object","description":"Platform deployment details","required":["cloud","supports_azure","supports_aws","high_availability","govcloud","image_id","nfs_enabled","local_workers","secrets_manager"],"properties":{"cloud":{"type":"string","description":"The cloud the platform is running in"},"supports_azure":{"type":"boolean","description":"Whether the platform supports Azure imports"},"supports_aws":{"type":"boolean","description":"Whether the platform supports AWS imports"},"high_availability":{"type":"boolean","description":"Whether the system is in a high availability configuration"},"govcloud":{"type":"boolean","description":"Is the platform running in AWS GovCloud"},"image_id":{"type":"string","description":"The image ID of the instance"},"nfs_enabled":{"type":"boolean","description":"Whether NFS is enabled"},"local_workers":{"type":"boolean","description":"Whether Local Workers are enabled"},"secrets_manager":{"type":"boolean","description":"Whether the respective cloud service secrets manager is enabled"}}},"warnings":{"type":"array","description":"Any warnings that should be displayed to the user","items":{"type":"object","required":["message","code"],"properties":{"message":{"type":"string","description":"The warning message"},"code":{"type":"string","description":"The warning code"}}}},"latest_boot":{"type":"number","description":"Unix timestamp of when the platform last booted"}}}}}}}},"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}}}}}}}}},"\/api\/v3\/auditlog\/investigations\/{investigation_id}":{"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Get audit history for a specific project","description":"Get audit history for a specific project (does not include GET information)","parameters":[{"name":"investigation_id","in":"path","required":true,"schema":{"type":"integer"},"description":"Investigation id"}],"tags":["Audit Log"],"security":[{"bearerAuth":[]}],"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Returns the audit logs for a specific project","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"default":"success"},"data":{"type":"object","properties":{"history":{"type":"array","items":{"type":"object","required":["id","username","user_id","timestamp","duration","event_type","resource_category","description","response","source","verb","route","request_body","url_args","files","platform_version","investigation_id","investigation_name"],"properties":{"investigation_name":{"type":"string","nullable":true},"investigation_id":{"type":"integer","nullable":true},"id":{"type":"integer"},"username":{"type":"string"},"user_id":{"type":"integer"},"timestamp":{"type":"number"},"duration":{"type":"integer","nullable":true},"event_type":{"type":"string"},"resource_category":{"type":"string"},"description":{"type":"string"},"response":{"type":"string"},"source":{"type":"string"},"verb":{"type":"string"},"route":{"type":"string"},"request_body":{"type":"object","nullable":true},"url_args":{"type":"object","nullable":true},"view_args":{"type":"object","nullable":true},"files":{"type":"array","nullable":true,"items":{"type":"object","properties":{"filename":{"type":"string"},"content_type":{"type":"string"},"content_length":{"type":"integer","nullable":true}}}},"platform_version":{"type":"string"}}}}}}}}}}}}}},"\/api\/v3\/detections\/rules":{"post":{"summary":"Create a new Detection Rule","description":"Create a Detection Rule which can detect matched events and respond depending on the rule configuration.","x-Required Roles":["Administrator","Lead Analyst"],"x-Feature Lifecycle":"beta","security":[{"bearerAuth":[]}],"tags":["Detections"],"parameters":[],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["name","description","alert_type"],"properties":{"name":{"type":"string","description":"The name of the Detection Rule being created."},"description":{"type":"string","description":"A brief description of the Detection Rule being created."},"alert_type":{"type":"string","description":"The alert type for the Detection Rule to match against.","default":"GuardDuty","enum":["GuardDuty","Defender","CrowdStrike","Wiz"]},"severity":{"type":"array","description":"The severities to match against.","items":{"type":"string","default":"medium","enum":["critical","high","medium","low"]}},"asset_type":{"type":"string","description":"The asset to match against GuardDuty Rules.","enum":["ec2"]},"accounts":{"type":"array","description":"An updated list of account names to be associated with the Detection Rule.","items":{"type":"string"}},"threat_purposes":{"type":"array","description":"A list of threat purposes to match against GuardDuty Rules.","items":{"type":"string","default":"UnauthorizedAccess","enum":["Backdoor","Behavior","CredentialAccess","Cryptocurrency","DefenseEvasion","Discovery","Execution","Exfiltration","Impact","InitialAccess","Pentest","Persistence","Policy","PrivilegeEscalation","Recon","Stealth","Trojan","UnauthorizedAccess"]}},"attack_techniques":{"type":"array","description":"A list of attack techniques to match Defender alerts against.","items":{"type":"string"}},"ebs_tag_key":{"type":"string","description":"The tag key used to search for EBS resources created by Wiz."},"ebs_tag_value":{"type":"string","description":"The tag value used to search for EBS resources created by Wiz."},"trigger_ebs_snapshot":{"type":"boolean","description":"Whether or not to acquire the full disk via EBS snapshot, only available for GuardDuty"},"response":{"type":"array","items":{"type":"object","required":["condition","action_id"],"properties":{"condition":{"type":"string","enum":["malicious","suspicious"]},"action_id":{"type":"integer"}},"description":"Response rule object"}}}}}}},"responses":{"200":{"description":"The resource ID of the Detection Rule created.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"enum":["success"],"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","description":"The data returned containing the resource ID of the Detection Rule created.","schema":null,"required":["detection_rule_id"],"properties":{"detection_rule_id":{"type":"integer","description":"The resource ID of the Detection Rule created."}}}}}}}},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}}},"get":{"summary":"Get all detection rules","description":"Retrieve all detection rules available to a user","x-Required Roles":["Administrator","Lead Analyst"],"x-Feature Lifecycle":"beta","security":[{"bearerAuth":[]}],"tags":["Detections"],"parameters":[{"name":"name","in":"query","required":false,"schema":{"type":"string"}},{"name":"asset_type","in":"query","required":false,"schema":{"type":"string","enum":["ec2"]}},{"name":"account_name","in":"query","required":false,"schema":{"type":"string"}},{"name":"alert_type","in":"query","required":false,"schema":{"type":"string","enum":["GuardDuty","Defender","CrowdStrike","Wiz"]}},{"name":"enabled","in":"query","required":false,"schema":{"type":"boolean"}},{"name":"id","in":"query","required":false,"schema":{"type":"integer"}},{"name":"severity","in":"query","required":false,"schema":{"type":"array","items":{"type":"string","enum":["critical","high","medium","low"]}}},{"name":"attack_techniques","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1},"description":"Which page of detection rule results to return."},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":50},"description":"How many detection rule results per page."}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"array","items":{"type":"object","required":["id","name","description","alert_type","enabled","created","last_modified","accounts"],"properties":{"id":{"type":"integer","description":"unique id of a Detection Rule"},"name":{"type":"string","description":"name of the Detection Rule"},"description":{"type":"string","description":"description of the Detection Rule"},"last_modified":{"type":"number","description":"date of last modification of the Detection Rule"},"created":{"type":"number","description":"date the Detection Rule was created"},"alert_type":{"type":"string","enum":["GuardDuty","Defender","CrowdStrike","Wiz"],"description":"type of alert that will help determine the response","example":"GuardDuty"},"severity":{"type":"array","items":{"type":"string","enum":["low","medium","high","critical"]},"example":["medium"],"description":"the level of severity"},"enabled":{"type":"boolean","description":"bool to signify if a Detection Rule is enabled or not"},"asset_type":{"type":"string","enum":["ec2"]},"accounts":{"type":"array","items":{"type":"object","required":["account_name"],"properties":{"account_name":{"type":"string","description":"The name of the account in the Cado Platform"},"public_identifier":{"type":"string","description":"The public identifier of the account"}}}},"response":{"type":"array","items":{"type":"object","required":["condition","action_id"],"properties":{"condition":{"type":"string","enum":["malicious","suspicious"]},"action_id":{"type":"integer"}},"description":"Response rule object"}},"threat_purposes":{"type":"array","items":{"type":"string","enum":["Backdoor","Behavior","CredentialAccess","Cryptocurrency","DefenseEvasion","Discovery","Execution","Exfiltration","Impact","InitialAccess","Pentest","Persistence","Policy","PrivilegeEscalation","Recon","Stealth","Trojan","UnauthorizedAccess"]}},"attack_techniques":{"type":"array","description":"A list of attack techniques to match Defender alerts against.","items":{"type":"string"}},"ebs_tag_key":{"type":"string","description":"The tag key used to search for EBS resources created by Wiz."},"ebs_tag_value":{"type":"string","description":"The tag value used to search for EBS resources created by Wiz."},"trigger_ebs_snapshot":{"type":"boolean","description":"Whether or not to acquire the full disk via EBS snapshot, only available for GuardDuty"}}}},"pagination":{"type":"object","properties":{"current_page":{"description":"The current page number","type":"integer"},"total_pages":{"description":"The total number of pages","type":"integer"},"total_records":{"description":"The total number of records","type":"integer"},"per_page":{"description":"The number of records per page","type":"integer"},"type":{"default":"page","description":"The type of the pagination","enum":["page"],"type":"string"}},"required":["total_records","current_page","total_pages","type"]},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["status","data","pagination"],"type":"object"}}},"description":"List of detection group items"},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}}}},"\/api\/v3\/detections\/rules\/info":{"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst"],"summary":"Get a list of detection rule types","description":"Returns a list of detection rule types.","security":[{"bearerAuth":[]}],"tags":["Detections"],"parameters":[{"name":"alert_type","in":"query","required":true,"schema":{"type":"string","enum":["GuardDuty","Defender","CrowdStrike","Wiz"]},"description":"Filter by alert type."}],"responses":{"200":{"description":"Detection rule types","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"default":"success","description":"The status of the response. In this context, the value will be \"success\".","enum":["success"],"type":"string"},"data":{"type":"object","properties":{"severity_options":{"type":"array","description":"available severity options for detection rules","items":{"type":"string","enum":["high","medium","critical","low"]}},"threat_purposes":{"type":"array","description":"available threat purposes for GuardDuty detection rules","items":{"type":"string","enum":["Backdoor","Behavior","CredentialAccess","Cryptocurrency","DefenseEvasion","Discovery","Execution","Exfiltration","Impact","InitialAccess","Pentest","Persistence","Policy","PrivilegeEscalation","Recon","Stealth","Trojan","UnauthorizedAccess"]}}}}}}}}},"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","enum":["error"],"description":"The status of the response, in this context, the value will be \"error\".","default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}}}}},"\/api\/v3\/detections\/rules\/{detection_rule_id}":{"delete":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst"],"summary":"Delete a Detection Rule","description":"Delete a Detection Rule corresponding to the provided Detection Rule ID.","tags":["Detections"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"detection_rule_id","in":"path","required":true,"description":"ID of the Detection Rule to delete.","schema":{"type":"integer","example":1}}],"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","enum":["error"],"description":"The status of the response, in this context, the value will be \"error\".","default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Successfully deleted Detection Rule.","content":{"application\/json":{"schema":{"type":"object","required":["status"],"properties":{"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}}}}}}}},"patch":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst"],"summary":"Update a Detection Rule","description":"Update a Detection Rule.","tags":["Detections"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"detection_rule_id","in":"path","required":true,"schema":{"type":"integer"},"description":"ID of the Detection Rule to be modified."}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","properties":{"name":{"type":"string","description":"The updated name of the Detection Rule."},"description":{"type":"string","description":"The updated description of the Detection Rule."},"enabled":{"type":"boolean","description":"bool to signify if a Detection Rule is enabled or not"},"severity":{"type":"array","items":{"type":"string","enum":["critical","high","medium","low"]},"description":"An updated list of severities to match against."},"threat_purposes":{"type":"array","description":"An updated list of threat purposes to match against GuardDuty Rules.","items":{"type":"string","default":"UnauthorizedAccess","enum":["Backdoor","Behavior","CredentialAccess","Cryptocurrency","DefenseEvasion","Discovery","Execution","Exfiltration","Impact","InitialAccess","Pentest","Persistence","Policy","PrivilegeEscalation","Recon","Stealth","Trojan","UnauthorizedAccess"]}},"asset_type":{"type":"string","description":"The updated asset to match against GuardDuty Rules.","enum":["ec2"]},"accounts":{"type":"array","description":"An updated list of account names to be associated with the Detection Rule.","items":{"type":"string"}},"response":{"type":"array","items":{"type":"object","required":["condition","action_id"],"properties":{"condition":{"type":"string","enum":["malicious","suspicious"]},"action_id":{"type":"integer"}},"description":"Response rule object"}},"attack_techniques":{"type":"array","description":"An updated list of attack techniques to match Defender alerts against.","items":{"type":"string"}},"ebs_tag_key":{"type":"string","description":"The updated tag key used to search for EBS resources created by Wiz."},"ebs_tag_value":{"type":"string","description":"The updated tag value used to search for EBS resources created by Wiz."},"trigger_ebs_snapshot":{"type":"boolean","description":"Whether or not to acquire the full disk via EBS snapshot, only available for GuardDuty"}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","enum":["error"],"description":"The status of the response, in this context, the value will be \"error\".","default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Details of the updated Detection Rule.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","enum":["success"],"description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","required":["id","name","description","alert_type","enabled","created","last_modified"],"properties":{"id":{"type":"integer","description":"Unique ID of the updated Detection Rule."},"name":{"type":"string","description":"Name of the updated Detection Rule."},"description":{"type":"string","description":"Description of the updated Detection Rule."},"last_modified":{"type":"number","description":"Unix Timestamp of last modification of the Detection Rule."},"created":{"type":"number","description":"Unix Timestamp of when the Detection Rule was created."},"alert_type":{"type":"string","enum":["GuardDuty","Defender","CrowdStrike","Wiz"],"description":"Type of alert that will help determine the response.","example":"GuardDuty"},"severity":{"type":"array","items":{"type":"string","enum":["low","medium","high","critical"]},"example":["medium"],"description":"the level of severity"},"enabled":{"type":"boolean","description":"Boolean to signify if the updated Detection Rule is enabled or not."},"asset_type":{"type":"string","enum":["ec2"]},"accounts":{"type":"array","items":{"type":"object","required":["account_name"],"properties":{"account_name":{"type":"string","description":"The name of the account in the Cado Platform"},"public_identifier":{"type":"string","description":"The public identifier of the account"}}}},"response":{"type":"array","items":{"type":"object","required":["condition","action_id"],"properties":{"condition":{"type":"string","enum":["malicious","suspicious"]},"action_id":{"type":"integer"}},"description":"Response rule object"}},"threat_purposes":{"type":"array","items":{"type":"string","enum":["Backdoor","Behavior","CredentialAccess","Cryptocurrency","DefenseEvasion","Discovery","Execution","Exfiltration","Impact","InitialAccess","Pentest","Persistence","Policy","PrivilegeEscalation","Recon","Stealth","Trojan","UnauthorizedAccess"]}},"attack_techniques":{"type":"array","description":"A list of attack techniques to match Defender alerts against.","items":{"type":"string"}},"ebs_tag_key":{"type":"string","description":"The tag key used to search for EBS resources created by Wiz."},"ebs_tag_value":{"type":"string","description":"The tag value used to search for EBS resources created by Wiz."},"trigger_ebs_snapshot":{"type":"boolean","description":"Whether or not to acquire the full disk via EBS snapshot, only available for GuardDuty"}}}}}}}}}}},"\/api\/v3\/settings\/secrets_manager":{"patch":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator"],"summary":"Update Secrets Manager settings","description":"Update Secrets Manager settings.","tags":["Settings"],"security":[{"bearerAuth":[]}],"requestBody":{"required":false,"content":{"application\/json":{"schema":{"type":"object","properties":{"keyvault_uri":{"type":"string","description":"The Key Vault name to be used as the Secrets Manager - Azure only"}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","enum":["error"],"description":"The status of the response, in this context, the value will be \"error\".","default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"A response indicating that Secrets Manager was successfully updated.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","enum":["success"],"description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting.","required":["message"],"properties":{"message":{"type":"string","description":"A description of the state of the Secrets Manager."}}}}}}}}}}},"\/api\/v3\/auth\/whoami":{"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Retrieve the identity of the currently signed in user","description":"Information about the current user","tags":["Authentication"],"security":[{"bearerAuth":[]}],"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Successfully got user information","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"default":"success"},"data":{"type":"object","required":["username","display_name","id","changed_password","eula_agreed","permissions","rbac_role"],"description":"The data object containing the user information","properties":{"username":{"type":"string","description":"The username of the user"},"id":{"type":"integer","description":"The id of the user"},"display_name":{"type":"string","description":"The display name of the user"},"changed_password":{"type":"boolean","description":"Does the user need to change their password"},"eula_agreed":{"type":"boolean","description":"Has the user agreed to the EULA"},"permissions":{"type":"object","description":"The permissions possibly available to the user","properties":{"actions_invoke":{"default":false,"type":"boolean"},"actions_read":{"default":false,"type":"boolean"},"actions_write":{"default":false,"type":"boolean"},"alarms_read":{"default":false,"type":"boolean"},"alarms_write":{"default":false,"type":"boolean"},"api_keys_create":{"default":false,"type":"boolean"},"api_keys_read":{"default":false,"type":"boolean"},"api_keys_revoke":{"default":false,"type":"boolean"},"auditlog_history_read":{"default":false,"type":"boolean"},"auditlog_read":{"default":false,"type":"boolean"},"auth_read":{"default":false,"type":"boolean"},"automations_read":{"default":false,"type":"boolean"},"automations_write":{"default":false,"type":"boolean"},"cloud_accounts_admin":{"default":false,"type":"boolean"},"cloud_accounts_read":{"default":false,"type":"boolean"},"cloud_accounts_write":{"default":false,"type":"boolean"},"detection_rules_read":{"default":false,"type":"boolean"},"detection_rules_write":{"default":false,"type":"boolean"},"detections_create_project":{"default":false,"type":"boolean"},"detections_export":{"default":false,"type":"boolean"},"detections_read":{"default":false,"type":"boolean"},"download_evidence":{"default":false,"type":"boolean"},"environments_read":{"default":false,"type":"boolean"},"environments_write":{"default":false,"type":"boolean"},"eula_sign":{"default":false,"type":"boolean"},"groups_admin":{"default":false,"type":"boolean"},"groups_read":{"default":false,"type":"boolean"},"groups_write":{"default":false,"type":"boolean"},"import_data":{"default":false,"type":"boolean"},"license_read":{"default":false,"type":"boolean"},"license_write":{"default":false,"type":"boolean"},"metrics_read":{"default":false,"type":"boolean"},"notifications_read":{"default":false,"type":"boolean"},"notifications_update":{"default":false,"type":"boolean"},"notifications_write":{"default":false,"type":"boolean"},"pipelines_abort":{"default":false,"type":"boolean"},"pipelines_abort_all":{"default":false,"type":"boolean"},"pipelines_admin":{"default":false,"type":"boolean"},"pipelines_logs":{"default":false,"type":"boolean"},"pipelines_read":{"default":false,"type":"boolean"},"pipelines_rerun":{"default":false,"type":"boolean"},"platform_status_read":{"default":false,"type":"boolean"},"projects_admin":{"default":false,"type":"boolean"},"projects_create":{"default":false,"type":"boolean"},"projects_delete":{"default":false,"type":"boolean"},"projects_read":{"default":false,"type":"boolean"},"projects_write":{"default":false,"type":"boolean"},"remote_actions_invoke":{"default":false,"type":"boolean"},"roles_read":{"default":false,"type":"boolean"},"saved_queries_read":{"default":false,"type":"boolean"},"saved_queries_write":{"default":false,"type":"boolean"},"settings_auth_read":{"default":false,"type":"boolean"},"settings_auth_write":{"default":false,"type":"boolean"},"settings_read":{"default":false,"type":"boolean"},"settings_scripts_read":{"default":false,"type":"boolean"},"settings_scripts_write":{"default":false,"type":"boolean"},"settings_write":{"default":false,"type":"boolean"},"settings_intelligence_write":{"default":false,"type":"boolean"},"settings_intelligence_read":{"default":false,"type":"boolean"},"system_logs":{"default":false,"type":"boolean"},"system_read":{"default":false,"type":"boolean"},"system_write":{"default":false,"type":"boolean"},"users_admin":{"default":false,"type":"boolean"},"users_list":{"default":false,"type":"boolean"},"users_read":{"default":false,"type":"boolean"},"users_write":{"default":false,"type":"boolean"},"webhook_read":{"default":false,"type":"boolean"},"webhook_write":{"default":false,"type":"boolean"},"workers_read":{"default":false,"type":"boolean"},"workers_write":{"default":false,"type":"boolean"}}},"rbac_role":{"type":"string","description":"The role of the user"}}}}}}}}}}},"\/api\/v3\/import\/cado-host":{"post":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Generate a Cado Host deployment script","description":"Generate a Cado Host deployment script with customizable options","tags":["Import using Cado Host"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["project_id","deployment","os","downloadable","command_options"],"properties":{"deployment":{"type":"string","description":"The deployment mode for Cado Host, auto will download and cleanup, manual assumes Cado Host is already on the endpoint.","enum":["auto","manual"],"default":"auto"},"os":{"type":"string","description":"The operating system of the endpoint you are deploying Cado Host to.","enum":["windows","osx","osx-x86","linux","kubernetes"],"default":"linux"},"downloadable":{"type":"boolean","description":"Whether to download the command as a stand-alone script."},"command_options":{"type":"object","description":"A list of customisable command line options to pass to the Cado Host deployment script","required":[],"properties":{"as_super":{"type":"boolean","description":"Add sudo to the command, does not apply to Windows."},"additional_files":{"type":"array","description":"List of additional file paths to acquire","items":{"type":"string"}},"light_mode":{"type":"boolean","description":"Whether to use light mode which collects files less than 10MB"},"max_mode":{"type":"boolean","description":"Whether to use max mode which collects a larger set of files, more likely to fail upload to cloud storage due to size"},"enable_memory":{"type":"boolean","description":"Whether to enable process memory acquisition using Cado varc"},"extended_memory":{"type":"boolean","description":"Whether to enable extended memory acquisition using Cado varc"},"verbose":{"type":"boolean","description":"Whether to enable verbose logging"},"no_clean":{"type":"boolean","description":"Whether to disable cleanup of the Cado Host deployment script"},"filename":{"type":"string","description":"The name of the zip file created by Cado Host"},"pod_name":{"type":"string","description":"The name of the Kubernetes pod to target with the Cado Host deployment script"},"pod_namespace":{"type":"string","description":"The namespace of the Kubernetes pod to target with the Cado Host deployment script"},"target_container":{"type":"string","description":"The name of the Kubernetes container to target with the Cado Host deployment script"},"drive_letter":{"type":"string","description":"The drive letter to use for the Cado Host deployment script on Windows"},"custom_container":{"type":"string","description":"The custom container image to optionally use for the debug acquisition container"},"is_non_root":{"type":"boolean","description":"Use a non-root user to acquire data from Kubernetes"},"groups":{"type":"array","description":"An array of supported Cado Host capture groups. The supported groups will depend on the operating system of the command being generated.","example":["program_execution","processes"],"items":{"type":"string"}},"skip_ssl_verify":{"type":"boolean","description":"Whether to skip SSL verification for the Cado Host deployment script"}}},"project_id":{"type":"integer","description":"The ID of the project to import related evidences into."}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Generated Cado Host deployment script","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"default":"success"},"data":{"type":"object","required":["command"],"properties":{"project_id":{"type":"integer","description":"The ID of the project used to create the Cado Host deployment command"},"command":{"type":"string","description":"The generated Cado Host deployment command"},"presigned_data":{"type":"string","description":"Encoded presigned Cloud Storage data for the generated Cado Host deployment command"},"cloud_storage_info":{"type":"object","required":["path"],"description":"Information about the Cloud Storage settings used to create the presigned data","properties":{"bucket":{"type":"string","description":"The name of the Cloud Storage bucket (AWS S3 or GCP Storage)"},"storage_account":{"type":"string","description":"The name of the storage account (Azure Storage)"},"container":{"type":"string","description":"The name of the storage container (Azure Storage)"},"path":{"type":"string","description":"The path to the file in the Cloud Storage bucket or container"}}}}}}}}}}}},"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Get a Cado Host download link","description":"Get a Cado Host download link for the specified operating system","tags":["Import using Cado Host"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"os","in":"query","required":true,"description":"The operating system of the endpoint","schema":{"type":"string","enum":["windows","osx","osx-x86","linux","kubernetes"]}}],"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Generated Cado Host deployment script","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"default":"success"},"data":{"type":"object","required":["link"],"properties":{"link":{"type":"string","description":"The Cado Host download link"}}}}}}}}}}},"\/api\/v3\/settings":{"patch":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator"],"summary":"Update settings","description":"Update settings.","tags":["Settings"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"$ref":"#\/components\/schemas\/settings_schema"}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"]}}}},"200":{"description":"A response indicating settings have successfully been applied","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting.","required":["message"],"properties":{"message":{"type":"string","description":"A description of the state of local worker mode."}}}}}}}}}},"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Get settings","description":"Get settings.","tags":["Settings"],"security":[{"bearerAuth":[]}],"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"]}}}},"200":{"description":"A response returning requested settings values.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"},"data":{"type":"object","$ref":"#\/components\/schemas\/settings_schema"}}}}}}}}},"\/api\/v3\/detections":{"get":{"summary":"Get detections","description":"List all detections visible to the current user","parameters":[{"name":"investigation_id","in":"query","required":false,"schema":{"type":"integer"},"description":"Filter by investigation\/project id."},{"name":"name","in":"query","required":false,"schema":{"type":"string"},"description":"Filter by detection name."},{"name":"resource_id","in":"query","required":false,"schema":{"type":"string"},"description":"Filter by detection resource id."},{"name":"severity","in":"query","required":false,"schema":{"type":"array","items":{"type":"string","enum":["critical","high","medium","low"]}},"description":"Filter by detection severity."},{"name":"impact","in":"query","required":false,"schema":{"type":"array","items":{"type":"string","enum":["critical","high","medium","low"]}},"description":"Filter by detection impact."},{"name":"status","in":"query","required":false,"schema":{"type":"array","items":{"type":"string","enum":["Collection & Analysis","Containment","Eradication","Recovery","Post incident activity","Closed"]}},"description":"Filter by project status."},{"name":"source","in":"query","required":false,"schema":{"type":"array","items":{"type":"string","enum":["GuardDuty","Defender","CrowdStrike","Wiz"]}},"description":"Filter by detection source."},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1},"description":"Which page of detection results to return."},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":10},"description":"How many detection results per page."},{"name":"order_by","in":"query","required":false,"schema":{"type":"string","enum":["id","-id","created_datetime","-created_datetime","updated_datetime","-updated_datetime","source","-source","resource_id","-resource_id","severity","-severity"],"default":"severity"},"description":"The way in which to order detection results."}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"array","items":{"type":"object","required":["id","name","finding_id","investigation_id","investigation","created_datetime","updated_datetime","severity","source","raw_event","status"],"properties":{"id":{"type":"integer","description":"ID of the detection"},"name":{"type":"string","description":"Name of the detection"},"description":{"type":"string","description":"Description of the detection"},"finding_id":{"type":"string","description":"Unique identifier for the detection finding"},"investigation_id":{"type":"integer","description":"ID of the detection investigation (project)"},"investigation":{"type":"string","description":"Name of the detection investigation (project)"},"created_datetime":{"type":"number","description":"First timestamp of the detection"},"updated_datetime":{"type":"number","description":"Most recent timestamp of the detection"},"severity":{"type":"string","description":"Severity of the detection"},"source":{"type":"string","description":"Source of the detection"},"impact":{"type":"string","description":"Impact of the detection"},"mitre":{"type":"array","items":{"type":"string","description":"A mitre attack"},"description":"An array of mitre attacks of the detection"},"raw_event":{"type":"string","description":"Raw data associated with the detection"},"artifacts":{"type":"object","description":"Specific artifacts about the detection"},"primary_artifact":{"type":"string","description":"Primary artifact of the detection"},"resource_id":{"type":"string","description":"Name of the resource for the detection"},"resource_type":{"type":"string","description":"Type of the resource for the detection"},"status":{"type":"string","description":"Status of the detection investigation (project)"},"cloud_account_id":{"type":"string","description":"AWS account id extracted from guard duty"},"event_id":{"type":"string","description":"Event ID from the timeline"}}}},"pagination":{"type":"object","properties":{"current_page":{"description":"The current page number","type":"integer"},"total_pages":{"description":"The total number of pages","type":"integer"},"total_records":{"description":"The total number of records","type":"integer"},"per_page":{"description":"The number of records per page","type":"integer"},"type":{"default":"page","description":"The type of the pagination","enum":["page"],"type":"string"}},"required":["total_records","current_page","total_pages","type"]},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["status","data","pagination"],"type":"object"}}},"description":"List of detections"},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"tags":["Detections"],"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"]}},"\/api\/v3\/detections\/counts":{"get":{"summary":"Get detection counts based on grouping","description":"List all detection counts visible to the current user","parameters":[{"name":"investigation_id","in":"query","required":false,"schema":{"type":"integer"},"description":"Filter by investigation\/project id."},{"name":"name","in":"query","required":false,"schema":{"type":"string"},"description":"Filter by detection name."},{"name":"resource_id","in":"query","required":false,"schema":{"type":"string"},"description":"Filter by detection resource id."},{"name":"severity","in":"query","required":false,"schema":{"type":"array","items":{"type":"string","enum":["critical","high","medium","low"]}},"description":"Filter by detection severity."},{"name":"impact","in":"query","required":false,"schema":{"type":"array","items":{"type":"string","enum":["critical","high","medium","low"]}},"description":"Filter by detection impact."},{"name":"status","in":"query","required":false,"schema":{"type":"array","items":{"type":"string","enum":["Collection & Analysis","Containment","Eradication","Recovery","Post incident activity","Closed"]}},"description":"Filter by project status."},{"name":"source","in":"query","required":false,"schema":{"type":"array","items":{"type":"string","enum":["GuardDuty","Defender","CrowdStrike","Wiz"]}},"description":"Filter by detection source."},{"name":"group_by","in":"query","required":true,"schema":{"type":"string","enum":["investigation_id","name","resource_id","severity","impact","source"]},"description":"Which field to group by."},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1},"description":"Which page of detection count results to return."},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":10},"description":"How many detection count results per page."},{"name":"order_by","in":"query","required":false,"schema":{"type":"string","enum":["grouped_field","-grouped_field","count","-count"],"default":"count"},"description":"The way in which to order detection count results."}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"array","items":{"type":"object","required":["grouped_field_item","count"],"properties":{"grouped_field_item":{"type":"string","description":"Detection field that has been grouped."},"count":{"type":"integer","description":"Number of occurrences of this field."}}}},"pagination":{"type":"object","properties":{"current_page":{"description":"The current page number","type":"integer"},"total_pages":{"description":"The total number of pages","type":"integer"},"total_records":{"description":"The total number of records","type":"integer"},"per_page":{"description":"The number of records per page","type":"integer"},"type":{"default":"page","description":"The type of the pagination","enum":["page"],"type":"string"}},"required":["total_records","current_page","total_pages","type"]},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["status","data","pagination"],"type":"object"}}},"description":"List of detection counts by grouped field items."},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"tags":["Detections"],"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"]}},"\/api\/v3\/detections\/groups":{"get":{"summary":"Get detection groups","description":"List all detection groups visible to the current user","parameters":[{"name":"investigation","in":"query","required":false,"schema":{"type":"string"},"description":"Filter by investigation\/project name."},{"name":"resource_id","in":"query","required":false,"schema":{"type":"string"},"description":"Filter by detection resource id."},{"name":"name","in":"query","required":false,"schema":{"type":"string"},"description":"Filter by detection name."},{"name":"severity","in":"query","required":false,"schema":{"type":"array","items":{"type":"string","enum":["critical","high","medium","low"]}},"description":"Filter by detection severity."},{"name":"impact","in":"query","required":false,"schema":{"type":"array","items":{"type":"string","enum":["critical","high","medium","low"]}},"description":"Filter by detection impact."},{"name":"status","in":"query","required":false,"schema":{"type":"array","items":{"type":"string","enum":["Collection & Analysis","Containment","Eradication","Recovery","Post incident activity","Closed"]}},"description":"Filter by project status."},{"name":"source","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}},"description":"Filter by detection source."},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1},"description":"Which page of detection results to return."},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":25},"description":"How many detection results per page."},{"name":"order_by","in":"query","required":false,"schema":{"type":"string","enum":["created_datetime","-created_datetime","updated_datetime","-updated_datetime","source","-source","resource_id","-resource_id","severity","-severity"],"default":"severity"},"description":"The way in which to order detection results."}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"array","items":{"type":"object","required":["investigation_id","investigation","severity","source","impact","status","created_datetime","updated_datetime","detection_count"],"properties":{"investigation_id":{"type":"integer","description":"ID of the investigation (project)"},"investigation":{"type":"string","description":"Name of the investigation (project)"},"resource_name":{"type":"string","description":"Name of the resource for the detection group"},"resource_type":{"type":"string","description":"Type of the resource for the detection"},"severity":{"type":"string","description":"Highest severity of the detection group"},"source":{"type":"array","items":{"type":"string","description":"A detection source"},"description":"An array of sources of the detection group"},"impact":{"type":"string","description":"Highest impact of the detection group"},"status":{"type":"string","description":"Status of the detection group investigation (project)"},"created_datetime":{"type":"number","description":"First timestamp of the detection group"},"updated_datetime":{"type":"number","description":"Most recent timestamp of the detection group"},"detection_count":{"type":"integer","description":"Number of detections in the group"},"detection_name":{"type":"string","description":"Name of the single detection in the group"},"os_platform":{"type":"string","description":"Os platform associated with the group resource"},"os_processor":{"type":"string","description":"OS processor associated with the group resource"},"os_version":{"type":"string","description":"OS version associated with the group resource"},"ip_address":{"type":"string","description":"IP address associated with the group resource"},"external_ip_address":{"type":"string","description":"IP address associated with the group resource"},"priority":{"type":"string","description":"Priority data associated with the group resource"},"group":{"type":"string","description":"Group data associated with the group resource"},"risk_score":{"type":"string","description":"Risk score data associated with the group resource"},"exposure_level":{"type":"string","description":"Exposure level data associated with the group resource"},"entra_id_device_id":{"type":"string","description":"Device ID data associated with the group resource"},"tags":{"type":"array","items":{"type":"string","description":"A tag associated with the group resource"},"description":"Tags associated with the group resource"},"resource_updated_datetime":{"type":"number","description":"Timestamp of the most recent evidence\/resource acqusition time"},"artifacts":{"type":"object","description":"Artifacts for all detections in the group"},"primary_artifact_count":{"type":"integer","description":"Number of primary artifacts in the group"},"cloud_account_id":{"type":"string","description":"AWS account id extracted from guard duty"},"mitre":{"type":"array","items":{"type":"string","description":"A mitre attack"},"description":"An array of mitre attacks of the detection"}}}},"pagination":{"type":"object","properties":{"current_page":{"description":"The current page number","type":"integer"},"total_pages":{"description":"The total number of pages","type":"integer"},"total_records":{"description":"The total number of records","type":"integer"},"per_page":{"description":"The number of records per page","type":"integer"},"type":{"default":"page","description":"The type of the pagination","enum":["page"],"type":"string"}},"required":["total_records","current_page","total_pages","type"]},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["status","data","pagination"],"type":"object"}}},"description":"List of detection groups, grouped by investigation\/project"},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"tags":["Detections"],"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"]}},"\/api\/v3\/detections\/import":{"post":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst"],"summary":"Trigger an automated investigation from a detection","description":"Manually trigger an automated investigation from a detection from a supported detection source.","tags":["Detections"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["detections"],"properties":{"detections":{"type":"array","description":"A list of detections from a supported detection source to investigate.","items":{"type":"object"}}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","enum":["error"],"description":"The status of the response, in this context, the value will be \"error\".","default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Details of the created pipeline and project.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","enum":["success"],"description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","description":"The data returned by the API of the created pipeline and project.","required":["pipeline_id"],"properties":{"pipeline_id":{"type":"integer","description":"The ID of the pipeline that was created."}}}}}}}}}}},"\/api\/v3\/detections\/export":{"get":{"description":"Export detections in csv file","summary":"Export detections in csv file","tags":["Detections"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta","security":[{"bearerAuth":[]}],"parameters":[{"name":"project_id","in":"query","required":false,"schema":{"type":"integer"},"description":"filter result by project id"},{"name":"from_date","in":"query","required":false,"schema":{"type":"number"},"description":"Only include detections after this timestamp."},{"name":"to_date","in":"query","required":false,"schema":{"type":"number"},"description":"Only include detections before this timestamp."}],"responses":{"200":{"content":{"text\/csv":{"schema":{"type":"string"}}},"description":"Return csv file to be downloaded"},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}}}},"\/api\/v3\/platform\/update":{"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Update information","description":"Get information about platform updates","tags":["Platform"],"security":[{"bearerAuth":[]}],"parameters":[],"responses":{"200":{"description":"Update information","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success","enum":["success"]},"data":{"type":"object","required":["version_info","allow_updates"],"description":"The data object containing update information","properties":{"version_info":{"type":"object","description":"Version information","required":["latest_version","latest_release_date","backend_version","backend_release_date","cado_host_version"],"properties":{"latest_version":{"type":"string","description":"The latest version of the platform"},"latest_release_date":{"type":"integer","description":"The release date of the latest version"},"backend_version":{"type":"string","description":"The current version of the platform"},"backend_release_date":{"type":"integer","description":"The release date of the current version"},"cado_host_version":{"type":"string","description":"The version of Cado Host the platform will use to perform triage and Kubernetes captures"}}},"allow_updates":{"type":"boolean","description":"Whether native updates are allowed. If deployed using Terraform, this will be False"}}}}}}}},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}}}},"\/api\/v3\/files\/file":{"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Get information about a file","description":"Get information about a file","tags":["Files"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"evidence_id","in":"query","required":true,"schema":{"type":"integer"}},{"name":"path","in":"query","required":true,"schema":{"type":"string"},"description":"file system path"}],"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Retrieved file information","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"default":"success"},"data":{"type":"object","required":["downloadable","sha256","indicators"],"properties":{"downloadable":{"type":"boolean","description":"Whether this files is available to download"},"last_modified":{"type":"number","description":"Modified timestamp"},"created":{"type":"number","description":"Created timestamp"},"accessed":{"type":"number","description":"Accessed timestamp"},"is_deleted":{"type":"boolean","description":"Whether this file is deleted"},"sha256":{"type":"string","description":"The sha256 of the file"},"strings":{"type":"string","description":"The strings extracted from file"},"file_size":{"type":"integer","description":"The size of the file in bytes"},"indicators":{"type":"array","items":{"type":"object","required":["source","severity","description"],"properties":{"source":{"type":"string","enum":["alarm","strings"],"description":"Where this indicator came from"},"severity":{"type":"integer"},"description":{"type":"string","description":"A description of what this indicator represents"},"match":{"type":"string","description":"The exact text matched by this indicator"}}}},"table":{"type":"object","description":"Tabular representation the file content","required":["columns","rows"],"properties":{"columns":{"type":"array","items":{"type":"string"}},"rows":{"type":"array","items":{"required":["data","children"],"properties":{"data":{"type":"array","items":{"type":"string"}},"children":{"type":"array","items":{"type":"object"}}}}}}},"virustotal":{"type":"array","description":"Virustotal results","items":{"type":"object","required":["scan","result"],"properties":{"scan":{"type":"string"},"result":{"type":"string"}}}},"ai_description":{"type":"string","description":"Cado AI descritpion of file content (beta)"}}}}}}}}}}},"\/api\/v3\/files\/file\/download":{"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Download full file content","description":"Download full file content","tags":["Files"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"evidence_id","in":"query","required":true,"schema":{"type":"integer"}},{"name":"path","in":"query","required":true,"schema":{"type":"string"},"description":"file system path"},{"name":"encryption_password","in":"query","required":false,"schema":{"type":"string"},"description":"password to create encrypted zip of file"}],"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Full file content","content":{"application\/zip":{"schema":{"type":"string","format":"binary"}}}}}}},"\/api\/v3\/files\/directory":{"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Get information about a directory","description":"Get information about a directory","tags":["Files"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"evidence_id","in":"query","required":true,"schema":{"type":"integer"}},{"name":"path","in":"query","required":true,"schema":{"type":"string"},"description":"file system path"},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1},"description":"Which page or results to return."},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":10},"description":"How many results per page."}],"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"default":"error"},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"Retrieved directory listing","content":{"application\/json":{"schema":{"type":"object","required":["status","data","pagination"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"default":"success"},"data":{"type":"array","items":{"type":"object","required":["name","type","is_deleted"],"properties":{"name":{"type":"string"},"type":{"type":"string","enum":["file","folder"],"description":"File or folder"},"last_modified":{"type":"number","description":"Modified timestamp"},"created":{"type":"number","description":"Created timestamp"},"accessed":{"type":"number","description":"Accessed timestamp"},"is_deleted":{"type":"boolean","description":"Whether this file is deletedfrom"},"severity":{"type":"integer","description":"Highest severity alarm in this file if type is file, or in any cotained file if directory"}}}},"pagination":{"type":"object","description":"Pagination information","required":["type","total_records","current_page","total_pages"],"properties":{"type":{"type":"string","enum":["page"],"default":"page","description":"A string indicating the type of pagination supported by the API. In this context, the value will be \"page\"."},"total_records":{"type":"integer","description":"An integer representing the total amount of data we're paging."},"current_page":{"type":"integer","description":"An integer representing the current page of data (we use this to work out next and previous pages). NOTE: this is 1-indexed (i.e. it starts at 1)."},"total_pages":{"type":"integer","description":"An integer representing the total number of pages."},"per_page":{"type":"integer","description":"An integer representing the number of records per page."}}}}}}}}}}},"\/api\/v3\/auth\/keys":{"get":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator"],"summary":"List all keys","description":"Get all API keys that aren't revoked.","tags":["Authentication"],"security":[{"bearerAuth":[]}],"parameters":[],"responses":{"200":{"description":"Return `tokens` list","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success","enum":["success"]},"data":{"type":"object","required":["tokens"],"properties":{"tokens":{"type":"array","items":{"type":"object","required":["id","user_id","public_key"],"properties":{"id":{"type":"integer"},"user_id":{"type":"integer"},"public_key":{"type":"string"},"last_used_timestamp":{"type":"number"}}}}}}}}}}},"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}}}}}}}},"post":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator"],"summary":"Create new API Key","description":"API key is a type of access token that does not expire.","tags":["Authentication"],"security":[{"bearerAuth":[]}],"requestBody":{"content":{"application\/json":{"schema":{"type":"object","required":[],"properties":{}}}}},"responses":{"200":{"description":"Returns the public and secret keys","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success","enum":["success"]},"data":{"type":"object","required":["secret_key","id","public_key"],"properties":{"secret_key":{"type":"string"},"id":{"type":"integer"},"public_key":{"type":"string"}}}}}}}},"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}}}}}}}},"delete":{"summary":"Revoke key","description":"Mark the given API Key as revoked in the database.","tags":["Authentication"],"security":[{"bearerAuth":[]}],"x-Required Roles":["Administrator"],"x-Feature Lifecycle":"beta","requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["id"],"properties":{"id":{"type":"integer","description":"ID of an API Key"}}}}}},"responses":{"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."},"200":{"content":{"application\/json":{"schema":{"properties":{"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["status"],"type":"object"}}},"description":"Revoked message"}}}},"\/api\/v3\/import\/aws\/s3\/buckets":{"get":{"summary":"Browse a list of S3 buckets","description":"Browse a list of S3 buckets inside a specific AWS account.","parameters":[{"name":"cloud_id","in":"query","required":true,"schema":{"type":"string"},"description":"The alias of the chosen AWS account to browse. See the <a href=\"#\">Clouds API<\/a> documentation for more info on obtaining the cloud_id for a specific AWS account."},{"name":"cursor","in":"query","required":false,"schema":{"type":"string"},"description":"The pointer to the next page given by the response of the previous\/current page."},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":10},"description":"The amount of items to be given per page. If left blank, the default will be 10."}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"array","items":{"type":"object","description":"An S3 bucket","required":["name","creation_date"],"properties":{"name":{"type":"string","description":"The name of the S3 bucket."},"creation_date":{"type":"number","description":"The date and time the S3 bucket was created."}}}},"pagination":{"type":"object","properties":{"type":{"type":"string","enum":["cursor"],"default":"cursor","description":"A string indicating the type of pagination supported by the API. In this context, the value will be \"cursor\"."},"current_token":{"type":"string","description":"A string representing the pointer to this current page."},"per_page":{"type":"integer","description":"The amount of items to be given per page."},"next_token":{"type":"string","description":"A string representing a cursor to the next page. Use this in place of the `cursor` attribute to get the next page."},"previous_token":{"type":"string","description":"A string representing a cursor to the previous page. Use this in place of the `cursor` attribute to get the previous page."}},"required":["type"]},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["data","status","pagination"],"type":"object"}}},"description":""},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"tags":["Import from AWS"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"}},"\/api\/v3\/import\/aws\/s3\/objects":{"get":{"summary":"Browse a list of S3 bucket objects","description":"Browse a list of S3 bucket objects inside a specific AWS account.","parameters":[{"name":"cloud_id","in":"query","required":true,"schema":{"type":"string"},"description":"The alias of the chosen AWS account to browse. See the <a href=\"#\">Clouds API<\/a> documentation for more info on obtaining the cloud_id for a specific AWS account."},{"name":"cursor","in":"query","required":false,"schema":{"type":"string"},"description":"The pointer to the next page given by the response of the previous\/current page."},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":10},"description":"The maximum amount of results to be given per query. The query returns anywhere between MAX\/2 and MAX results due to how the S3 API operates. If left blank, the default will be 10."},{"name":"bucket_name","in":"query","required":true,"description":"The bucket to get contents from","schema":{"type":"string"}},{"name":"delimiter","in":"query","required":false,"description":"The delimeter used to separate paths in the file name. Defaults to \"\/\"","schema":{"type":"string"}},{"name":"prefix","in":"query","required":false,"description":"The prefix to filter the objects by. Must end in a \"\/\"","schema":{"type":"string"}}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"array","items":{"type":"object","description":"An S3 bucket object","oneOf":[{"type":"object","description":"A file object in S3","required":["name","type","last_modified","size","storage_class"],"properties":{"type":{"type":"string","enum":["FILE"],"default":"FILE"},"name":{"type":"string","example":"auth.log","description":"The filename of the S3 object"},"last_modified":{"type":"number","example":7959334942000,"description":"The timestamp of the last modification of the S3 object"},"size":{"type":"number","example":804756,"description":"The size of the S3 object in bytes"},"storage_class":{"type":"string","example":"STANDARD","description":"The storage class of the S3 object"}}},{"type":"object","description":"An object representing a folder in S3","required":["name","type"],"properties":{"type":{"type":"string","enum":["FOLDER"],"default":"FOLDER"},"name":{"type":"string","example":"auth.log","description":"The name of the folder"}}}]}},"pagination":{"type":"object","properties":{"type":{"type":"string","enum":["cursor"],"default":"cursor","description":"A string indicating the type of pagination supported by the API. In this context, the value will be \"cursor\"."},"current_token":{"type":"string","description":"A string representing the pointer to this current page."},"per_page":{"type":"integer","description":"The amount of items to be given per page."},"next_token":{"type":"string","description":"A string representing a cursor to the next page. Use this in place of the `cursor` attribute to get the next page."},"previous_token":{"type":"string","description":"A string representing a cursor to the previous page. Use this in place of the `cursor` attribute to get the previous page."}},"required":["type"]},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["data","status","pagination"],"type":"object"}}},"description":""},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"tags":["Import from AWS"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"}},"\/api\/v3\/import\/aws\/s3":{"post":{"summary":"Create S3 bucket acquire task","description":"Create a new task to acquiring new evidence from S3 bucket. Can acquire the entire s3 bucket or a specific file.","tags":["Import from AWS"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta","security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["bucket","project_id"],"properties":{"project_id":{"type":"integer"},"bucket":{"type":"string","example":"jf-bucket-1234"},"file_name":{"type":"string","example":"auth.log"},"prefix":{"type":"string","example":"directory_1\/"},"cloud_id":{"type":"string","description":"The AWS credentials alias that belongs to the account you want to retrieve buckets from."},"token":{"type":"string","description":"The AWS JIT token to use for the acquisition"}}}}}},"responses":{"200":{"description":"Task created","content":{"application\/json":{"schema":{"required":["data","status"],"properties":{"status":{"enum":["success"],"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","required":["pipeline_id"],"properties":{"pipeline_id":{"type":"integer"}}}}}}}},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}}}},"\/api\/v3\/workers":{"get":{"description":"Returns a list of all workers.","parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1},"description":"Which page of results to return"},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":10},"description":"How many results per page"},{"name":"status","description":"Filter by worker status","in":"query","required":false,"schema":{"type":"string","enum":["active","pending","terminating"]}},{"name":"evidence_name","description":"Filter by evidence name","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"array","items":{"type":"object","required":["id","status","instance_type","launch_time"],"properties":{"id":{"type":"string","description":"instance id"},"status":{"type":"string","description":"pending, active, terminating"},"evidence_id":{"type":"integer","description":"evidence id"},"evidence_name":{"type":"string","description":"evidence name"},"project_id":{"type":"integer","description":"evidence id"},"instance_type":{"type":"string","description":"instance type"},"launch_time":{"type":"number","description":"instance launch time (ms since epoch)"},"url":{"type":"string","description":"cloud portal url"}}}},"pagination":{"type":"object","properties":{"current_page":{"description":"The current page number","type":"integer"},"total_pages":{"description":"The total number of pages","type":"integer"},"total_records":{"description":"The total number of records","type":"integer"},"per_page":{"description":"The number of records per page","type":"integer"},"type":{"default":"page","description":"The type of the pagination","enum":["page"],"type":"string"}},"required":["type","total_records","current_page","total_pages"]},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["status","data","pagination"],"type":"object"}}},"description":"List of workers"},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"summary":"List all workers","tags":["Workers"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"}},"\/api\/v3\/workers\/{instance_id}":{"get":{"description":"Get a worker by instance ID.","parameters":[{"description":"The instance ID of the worker to retrieve.","in":"path","name":"instance_id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Successful worker retrieval","content":{"application\/json":{"schema":{"properties":{"data":{"type":"object","required":["instance_id","status","instance_type","launch_time"],"properties":{"instance_id":{"type":"string","description":"instance id"},"status":{"type":"string","description":"pending, active, terminating"},"evidence_id":{"type":"integer","description":"evidence id"},"evidence_name":{"type":"string","description":"evidence name"},"project_id":{"type":"integer","description":"project id"},"instance_type":{"type":"string","description":"instance type"},"launch_time":{"type":"number","description":"instance launch time (ms since epoch)"},"url":{"type":"string","description":"cloud portal url"}}},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["status","data"],"type":"object"}}}},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"summary":"Get a singular worker","tags":["Workers"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"},"delete":{"description":"Terminates a worker in either AWS or Azure.","parameters":[{"description":"Id of the instance to terminate.","name":"instance_id","in":"path","required":true,"schema":{"type":"string","example":1}}],"responses":{"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."},"200":{"content":{"application\/json":{"schema":{"properties":{"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["status"],"type":"object"}}},"description":"Successful termination of worker."}},"security":[{"bearerAuth":[]}],"summary":"Terminate Worker","tags":["Workers"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"}},"\/api\/v3\/import\/entra":{"post":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Import a set of Microsoft Entra ID logs","description":"Import a set of Microsoft Entra ID Audit and Sign-in logs.","tags":["Import from Microsoft Entra ID"],"security":[{"bearerAuth":[]}],"parameters":[],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["start_time","end_time","credentials","investigation_id"],"properties":{"start_time":{"description":"The start time of the logs to import. This should be in Unix Epoch format.","type":"integer"},"end_time":{"description":"The end time of the logs to import. This should be in Unix Epoch format.","type":"integer"},"credentials":{"description":"The credentials to use to authenticate with the Microsoft Entra ID API.","type":"string"},"user_ids":{"description":"A list of user IDs to import logs for. If not provided, logs for all users will be imported.","type":"array","items":{"type":"string"}},"investigation_id":{"description":"The ID of associated Cado investigation where logs will be imported into.","type":"integer"}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","default":"error","enum":["error"]},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"A new pipeline object is returned, indicating a successful kick-off of a pipeline. You can see the <a href=\"https:\/\/cado-security.github.io\/api-reference\/#tag\/Pipelines\/paths\/~1api~1v3~1pipelines~1{id}\/get\">Pipeline API<\/a> documentation for information on getting details about this pipeline.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"enum":["success"],"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","description":"The data containing the new processing pipeline.","schema":null,"required":["pipeline_id"],"properties":{"pipeline_id":{"type":"integer","description":"The ID of the import pipeline created."}}}}}}}}}}},"\/api\/v3\/import\/aws\/lambda":{"get":{"summary":"Browse a list of Lambda functions","description":"Browse a list of Lambda functions inside a specific AWS region and account.","parameters":[{"name":"cloud_id","in":"query","required":true,"schema":{"type":"string"},"description":"The alias of the chosen AWS account to browse. See the <a href=\"#\">Clouds API<\/a> documentation for more info on obtaining the cloud_id for a specific AWS account."},{"name":"region","in":"query","required":true,"schema":{"type":"string"},"description":"The AWS region to browse Lambda functions in."},{"name":"cursor","in":"query","required":false,"schema":{"type":"string"},"description":"The pointer to the next page given by the response of the previous\/current page."},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":10},"description":"The amount of items to be given per page. If left blank, the default will be 10."}],"responses":{"200":{"content":{"application\/json":{"schema":{"properties":{"data":{"type":"array","items":{"type":"object","description":"An Lambda function","required":["name","last_modified","package_type"],"properties":{"name":{"type":"string","description":"The name of the Lambda function."},"last_modified":{"type":"number","description":"The date and time the Lambda function was last modified."},"package_type":{"type":"string","description":"The package type of the Lambda function."}}}},"pagination":{"type":"object","properties":{"type":{"type":"string","enum":["cursor"],"default":"cursor","description":"A string indicating the type of pagination supported by the API. In this context, the value will be \"cursor\"."},"current_token":{"type":"string","description":"A string representing the pointer to this current page."},"per_page":{"type":"integer","description":"The amount of items to be given per page."},"next_token":{"type":"string","description":"A string representing a cursor to the next page. Use this in place of the `cursor` attribute to get the next page."},"previous_token":{"type":"string","description":"A string representing a cursor to the previous page. Use this in place of the `cursor` attribute to get the previous page."}},"required":["type"]},"status":{"default":"success","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"type":"string"}},"required":["data","status","pagination"],"type":"object"}}},"description":""},"default":{"content":{"application\/json":{"schema":{"properties":{"code":{"description":"An error code that can be given to Cado support for further troubleshooting.","type":"string"},"data":{"description":"Any supporting data returned by the API that can help with further troubleshooting.","type":"object"},"message":{"description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting.","type":"string"},"status":{"default":"error","description":"The status of the response, in this context, the value will be \"error\".","enum":["error"],"type":"string"}},"required":["status","message","code"],"type":"object"}}},"description":"A response indicating an error has occurred."}},"security":[{"bearerAuth":[]}],"tags":["Import from AWS"],"x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta"},"post":{"x-Feature Lifecycle":"beta","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"summary":"Start an import of an Lambda function into a specified project","description":"Start an import of a running Lambda container into the specified project. A processing pipeline will be returned that details the status of the processing.","tags":["Import from AWS"],"security":[{"bearerAuth":[]}],"parameters":[],"requestBody":{"required":true,"content":{"application\/json":{"schema":{"type":"object","required":["function","region","project_id"],"properties":{"function":{"type":"string","description":"The name of the Lambda function you wish to import."},"cloud_id":{"type":"string","description":"The alias of the chosen AWS account to browse. See the <a href=\"#\">Clouds API<\/a> documentation for more info on obtaining the cloud_id for a specific AWS account."},"region":{"type":"string","description":"The AWS region where the Lambda is located."},"project_id":{"type":"integer","description":"The ID of the Cado project that you want to import the data into."},"token":{"type":"string","description":"The AWS STS token that can be used for the import."}}}}}},"responses":{"default":{"description":"A response indicating an error has occurred.","content":{"application\/json":{"schema":{"type":"object","required":["status","message","code"],"properties":{"status":{"type":"string","description":"The status of the response, in this context, the value will be \"error\".","default":"error","enum":["error"]},"message":{"type":"string","description":"The error message returned by the API. In some cases, the message will contain a link to documentation for further troubleshooting."},"code":{"type":"string","description":"An error code that can be given to Cado support for further troubleshooting."},"data":{"type":"object","description":"Any supporting data returned by the API that can help with further troubleshooting."}}}}}},"200":{"description":"A new pipeline object is returned, indicating a successful kick-off of a pipeline. You can see the <a href=\"https:\/\/cado-security.github.io\/api-reference\/#tag\/Pipelines\/paths\/~1api~1v3~1pipelines~1{id}\/get\">Pipeline API<\/a> documentation for information on getting details about this pipeline.","content":{"application\/json":{"schema":{"type":"object","required":["status","data"],"properties":{"status":{"enum":["success"],"type":"string","description":"The status of the response, in this context, the value will be \"success\".","default":"success"},"data":{"type":"object","description":"The data containing the new processing pipeline.","schema":null,"required":["pipeline_id"],"properties":{"pipeline_id":{"type":"integer","description":"The numerical ID assigned to the pipeline."}}}}}}}}}}},"\/api\/v3\/groups":{"get":{"summary":"Get a list of groups","description":"Get a list of groups added to the Cado platform.","x-Required Roles":["Administrator","Lead Analyst","Analyst"],"x-Feature Lifecycle":"beta","tags":["Groups"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"group_name","in":"query","required":false,"schema":{"type":"string"},"description":"Filter by group name."},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1},"description":"The page of items to retrieve."},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":10},"description":"The amount of items to be given per page. If left blank, the default will be 10."}],"responses":{"default":{"$ref":"#\/components\/responses\/default"},"200":{"description":"Succesfully retrieved a list of groups.","content":{"application\/json":{"schema":{"type":"objects","required":["status","data","pagination"],"properties":{"pagination":{"$ref":"#\/components\/schemas\/pagination"},"status":{"type":"string","description":"The status of the response, in this context, the value will be \"success\".","enum":["success"],"default":"success"},"data":{"description":"A list of groups.","type":"array","items":{"type":"object","required":["id","name","user_count","role_count"],"properties":{"id":{"type":"integer","description":"The ID of the group."},"name":{"type":"string","description":"The name of the group"},"sso_group_name":{"type":"string","description":"The name of the group that manages these users in the SSO system."},"user_count":{"type":"integer","description":"The number of users assigned to the group."},"role_count":{"type":"integer","description":"The number of roles assigned to the group."}}}}}}}}}}}}}}